<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CEREBREXIA'25 - Events</title>

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Savate:wght@518&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Exo:wght@400;700;900&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-analytics.js"></script>


<style>
    /* Base and Reset */
    :root {
        --primary-glow-color: #50c8ff;
        --secondary-glow-color: #7efcff;
        --text-color: #ffffff;
        --dark-bg: #0a0e1a;
        --medium-bg: #10182c;
        --title-box-bg: #2a3045;
        --title-box-border: #607080;
        --button-blue: #007bff;
        --icon-blue: #3cb5f5;
        --medical-icon-color: #ffffff;
    }

    * { box-sizing: border-box; }
    html {
        background-color: #0d001f; /* Fallback background for the page */
        scroll-behavior: smooth;
    }
    body, html {
        margin: 0; padding: 0; min-height: 100vh;
        font-family: 'Kanit', sans-serif;
        color: #e0e0e0;
        overflow-x: hidden;
    }
    body {
        background-color: transparent; /* Allow video background to show through if any */
        position: relative; /* For stacking context if needed */
    }

    /* Consistent Header Styles (from index.html) */
    header {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        background: rgba(13, 0, 31, 0.85);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        z-index: 1000;
        transition: transform 0.3s ease;
        padding: 15px 20px;
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: space-between;
    }
    header.hidden { transform: translateY(-100%); }
    header.visible { transform: translateY(0); }
    .logo {
        font-family: 'Savate', sans-serif;
        font-size: 3rem;
        font-weight: 518;
        color: yellow;
        user-select: none;
        text-decoration: none;
        z-index: 1001;
    }
    .new-menu-toggle-button { background: transparent; border: none; color: #fff; cursor: pointer; padding: 10px; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 1101; transition: transform 0.3s ease; }
    .new-menu-toggle-button .icon-bar { display: block; width: 30px; height: 3px; background-color: #fff; margin: 6px 0; transition: transform 0.3s ease, opacity 0.3s ease, background-color 0.3s ease; border-radius: 1px; }
    .new-menu-toggle-button:hover .icon-bar { background-color: #ff00ff; }
    .new-menu-toggle-button.open .icon-bar:nth-child(1) { transform: translateY(9px) rotate(45deg); }
    .new-menu-toggle-button.open .icon-bar:nth-child(2) { opacity: 0; }
    .new-menu-toggle-button.open .icon-bar:nth-child(3) { transform: translateY(-9px) rotate(-45deg); }


    /* Fullscreen Nav styles (from index.html) */
    #fullScreenNav {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(13, 0, 31, 0.97); backdrop-filter: blur(5px); -webkit-backdrop-filter: blur(5px);
        z-index: 1100; display: flex; flex-direction: column; align-items: center; justify-content: center;
        opacity: 0; visibility: hidden; transition: opacity 0.5s ease, visibility 0s linear 0.5s; overflow-y: auto;
    }
    #fullScreenNav.active { opacity: 1; visibility: visible; transition: opacity 0.5s ease, visibility 0s linear 0s; }
    #fullScreenNav ul { list-style: none; padding: 0; margin: 0; text-align: center; }
    #fullScreenNav li { margin: 20px 0; }
    #fullScreenNav a {
        font-family: 'Exo', sans-serif; font-weight: 400; font-size: clamp(2rem, 5vw, 3rem);
        color: #fff; text-decoration: none; padding: 10px 25px; display: inline-block;
        position: relative; transition: color 0.4s ease, transform 0.4s ease; letter-spacing: 1px; text-transform: uppercase;
    }
    #fullScreenNav a::before, #fullScreenNav a::after {
        content: ''; position: absolute; width: 100%; height: 3px;
        background: linear-gradient(90deg, #ff00ff, #ffae00, #00ffff, #ff00ff);
        background-size: 300% 100%; left: 0;
        transition: transform 0.4s ease, opacity 0.4s ease; animation: borderFlow 8s linear infinite;
    }
    #fullScreenNav a::before { top: 0; transform: scaleX(0); transform-origin: left; }
    #fullScreenNav a::after { bottom: 0; transform: scaleX(0); transform-origin: right; }
    #fullScreenNav a:hover, #fullScreenNav a:focus { color: #ffdd57; transform: translateY(-5px) scale(1.05); }
    #fullScreenNav a:hover::before, #fullScreenNav a:focus::before { transform: scaleX(1); transform-origin: right; }
    #fullScreenNav a:hover::after, #fullScreenNav a:focus::after { transform: scaleX(1); transform-origin: left; }
    @keyframes borderFlow { 0% { background-position: 0% 50%; } 100% { background-position: 300% 50%; } }
    #fullScreenNav .nav-close-btn { position: absolute; top: 10px; right: 20px; background: transparent; color: #aaa; border: none; font-size: 2.5rem; font-weight: bold; cursor: pointer; z-index: 1201; transition: color 0.3s ease, transform 0.3s ease; line-height: 1; }
    #fullScreenNav .nav-close-btn:hover { color: #ff00ff; transform: rotate(90deg) scale(1.1); }
    /* Active Link Specific Style (Events page specific for current page) */
    #fullScreenNav a.active-nav-link {
        color: #ffd700; /* Gold for active link */
        text-shadow: 0 0 8px #ffd700, 0 0 15px rgba(255, 215, 0, 0.7);
    }
    #fullScreenNav a.active-nav-link::before,
    #fullScreenNav a.active-nav-link::after {
        width: 100%; /* Ensure active link borders are always full width */
        transform: scaleX(1);
        animation: none; /* No flowing animation on active link */
        background-position: 0% 50%; /* Static background for active link */
    }


    main.container { max-width: 1200px; margin: 100px auto 60px; padding: 20px; }
    h1.page-title {
        font-size: 3rem; color: #ffffff; text-align: center; margin-bottom: 40px;
        user-select: none; text-shadow: 0 0 10px #ffffff, 0 0 20px #eeeeee;
        font-family: 'Orbitron', sans-serif; font-weight: 700; letter-spacing: 2px;
    }

    /* Filter Buttons */
    .filter-container { margin-bottom: 30px; text-align: center; }
    .filter-group { margin-bottom: 15px; }
    .filter-group label {
        font-size: 1.1rem; color: #ff99ff; font-weight: bold;
        margin-right: 10px; font-family: 'Exo', sans-serif;
    }
    .filter-button {
        background: rgba(255,0,255,0.2); border: 1px solid #ff00ff; color: #fff;
        padding: 8px 15px; margin: 5px; border-radius: 20px; cursor: pointer;
        transition: background-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
        font-family: 'Share Tech Mono', monospace; font-size: 0.9rem;
    }
    .filter-button.active, .filter-button:hover {
        background-color: #ff00ff; color: #0d001f; box-shadow: 0 0 10px #ff00ff, 0 0 15px #ff00ff;
    }

    .events-grid {
        display: grid; grid-template-columns: repeat(auto-fit,minmax(300px,1fr)); gap: 30px;
    }
    .event-card {
        background: rgba(255,0,255,0.08); border: 1px solid rgba(255,0,255,0.3);
        border-radius: 15px; box-shadow: 0 0 10px rgba(255,0,255,0.3), 0 0 20px rgba(255,102,255,0.2);
        overflow: hidden; transition: transform 0.3s ease, box-shadow 0.3s ease;
        display: flex; flex-direction: column; cursor: pointer;
    }
    .event-card:hover {
        transform: translateY(-5px) scale(1.03);
        box-shadow: 0 0 25px rgba(255,0,255,0.5), 0 0 45px rgba(255,102,255,0.4);
    }
    .event-image { width: 100%; height: 200px; object-fit: cover; border-bottom: 2px solid #ff00ff; }
    .event-content { padding: 20px; flex-grow: 1; display: flex; flex-direction: column; }
    .event-title {
        font-size: 1.7rem; font-weight: 700; margin-bottom: 8px;
        color: #f0c4ff; user-select: none; font-family: 'Exo', sans-serif;
    }
    .event-fee {
        font-family: 'Share Tech Mono', monospace; font-size: 1.1rem; color: #50fa7b;
        font-weight: bold; margin-bottom: 10px; letter-spacing: 1px; text-shadow: 0 0 5px #50fa7b;
    }
    .event-short-description { font-size: 0.95rem; color: #ccc; margin-bottom: 12px; line-height: 1.5; }
    .event-date {
        font-size: 0.9rem; color: #8be9fd; font-family: 'Share Tech Mono', monospace;
        letter-spacing: 1.5px; margin-bottom: 15px;
    }

    /* Accordion Styles */
    .accordion-header {
        background-color: rgba(51,0,77,0.7); color: #e0e0e0; padding: 10px 15px;
        border-radius: 8px; cursor: pointer; display: flex; justify-content: space-between;
        align-items: center; margin-top: auto; font-weight: 600;
        transition: background-color 0.3s ease; border: 1px solid rgba(255,0,255,0.2);
    }
    .accordion-header:hover { background-color: rgba(85,0,128,0.8); border-color: rgba(255,0,255,0.4); }
    .accordion-header::after { content: '+'; font-size: 1.5rem; transition: transform 0.3s ease; color: #ff00ff; }
    .accordion-header.active::after { content: '-'; }
    .accordion-content {
        max-height: 0; overflow-y: auto;
        transition: max-height 0.5s ease-in-out, padding 0.5s ease-in-out;
        background: rgba(255,0,255,0.03); border-radius: 0 0 10px 10px; padding: 0 15px;
        color: #d0d0d0; border: 1px solid rgba(255,0,255,0.1); border-top: none;
    }
    .accordion-content.open { max-height: 400px; padding: 15px; }
    .accordion-content p { margin-bottom: 10px; line-height: 1.6; }
    .accordion-content ul { margin: 0; padding-left: 20px; }
    .accordion-content ul li { margin-bottom: 5px; }
    .accordion-content strong { color: #ff99ff; }

    /* Modal Styles */
    .event-modal {
        display: none; position: fixed; z-index: 2000; left: 0; top: 0;
        width: 100%; height: 100%; overflow: auto; background-color: rgba(13, 0, 31, 0.85);
        backdrop-filter: blur(5px); -webkit-backdrop-filter: blur(5px); padding-top: 5vh;
    }
    .event-modal-content {
        background: rgba(20, 3, 40, 0.95); margin: auto; padding: 25px 30px;
        border: 1px solid #ff00ff; width: 90%; max-width: 650px;
        border-radius: 15px; box-shadow: 0 0 30px rgba(255, 0, 255, 0.5), 0 0 15px rgba(0, 255, 255, 0.3);
        position: relative; animation: modalFadeIn 0.5s ease-out;
    }
    @keyframes modalFadeIn { from { opacity: 0; transform: translateY(-30px) scale(0.95); } to { opacity: 1; transform: translateY(0) scale(1); } }
    .event-modal-close {
        color: #aaa; position: absolute; top: 10px; right: 20px;
        font-size: 2.5rem; font-weight: bold; transition: color 0.3s ease, transform 0.3s ease;
    }
    .event-modal-close:hover, .event-modal-close:focus {
        color: #ff00ff; text-decoration: none; cursor: pointer; transform: rotate(90deg) scale(1.1);
    }
    .modal-title {
        font-family: 'Orbitron', sans-serif; color: #00ffff;
        text-shadow: 0 0 8px #00ffff; margin-bottom: 5px;
    }
    .modal-event-fee {
        font-family: 'Share Tech Mono', monospace; color: #50fa7b;
        margin-bottom: 20px; font-size: 1.1rem;
    }
    .modal-form .form-group { margin-bottom: 18px; }
    .modal-form label {
        display: block; margin-bottom: 6px; font-weight: 500;
        color: #ff99ff; font-size: 0.9rem;
    }
    .modal-form input[type="text"],
    .modal-form input[type="email"],
    .modal-form input[type="tel"],
    .modal-form input[type="number"],
    .modal-form input[type="url"],
    .modal-form select,
    .modal-form textarea {
        width: 100%; padding: 10px 12px; background-color: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(0, 255, 255, 0.3); border-radius: 8px; color: #e0e0e0;
        font-family: 'Kanit', sans-serif; font-size: 0.95rem; transition: border-color 0.3s, box-shadow 0.3s;
    }
    .modal-form input:focus,
    .modal-form select:focus,
    .modal-form textarea:focus {
        outline: none; border-color: #ff00ff; box-shadow: 0 0 10px rgba(255, 0, 255, 0.5);
    }
    .modal-form textarea { resize: vertical; min-height: 80px; }
    .modal-form .terms-label { font-size: 0.85rem; color: #ccc; display: flex; align-items: center; }
    .modal-form input[type="checkbox"] {
        margin-right: 8px; accent-color: #ff00ff; width: 16px; height: 16px;
    }
    .modal-submit-btn {
        width: 100%; padding: 12px; background: linear-gradient(45deg, #e600e6, #7c16cb);
        color: white; border: none; border-radius: 8px; font-family: 'Exo', sans-serif;
        font-weight: 700; font-size: 1.1rem; cursor: pointer; transition: all 0.3s ease;
        margin-top: 10px; text-transform: uppercase; letter-spacing: 1px;
    }
    .modal-submit-btn:hover {
        transform: scale(1.03); box-shadow: 0 0 15px rgba(230,0,230,0.6), 0 0 10px rgba(124,22,203,0.5);
    }
    .modal-submit-btn:disabled { background: #555; cursor: not-allowed; opacity: 0.7; }
    #formResponseMessage {
        margin-top: 15px; padding: 10px; border-radius: 8px; text-align: center; font-weight: 500;
    }
    #formResponseMessage.success { background-color: rgba(0, 255, 127, 0.2); color: #50fa7b; border: 1px solid #50fa7b; }
    #formResponseMessage.error { background-color: rgba(255, 0, 0, 0.2); color: #ff4d4d; border: 1px solid #ff4d4d; }
    .hidden-field { display: none !important; }


    /* Footer Styles (from index.html) */
    .site-footer { background-color: #1a1a2e; color: #e0e0e0; padding: 30px 20px 30px; font-family: 'Kanit', sans-serif; margin-top: 60px; border-top: 3px solid #3a3a5e; box-shadow: 0 -5px 15px rgba(25, 25, 46, 0.5); }
    .footer-container-new { max-width: 1200px; margin: 0 auto; display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 35px; }
    .footer-section-new { padding: 10px; }
    .footer-heading-new { font-size: 1.6em; font-weight: 600; color: #f9c74f; margin-bottom: 25px; position: relative; padding-left: 20px; font-family: 'Exo', sans-serif; }
    .footer-heading-new::before { content: '●'; color: #f9c74f; position: absolute; left: 0; top: 50%; transform: translateY(-50%); font-size: 0.8em; }
    .footer-quick-links-list { list-style: none; padding: 0; margin: 0; display: flex; flex-wrap: wrap; }
    .footer-quick-links-list li { margin-right: 12px; margin-bottom: 12px; }
    .footer-quick-links-list li a { display: inline-block; background-color: #2a2a4e; color: #ffffff; padding: 12px 22px; text-decoration: none; border-radius: 25px; font-size: 1.1em; font-weight: 500; transition: background-color 0.3s ease, transform 0.2s ease; border: 1px solid #3a3a5e; }
    .footer-quick-links-list li a:hover, .footer-quick-links-list li a:focus { background-color: #f9c74f; color: #1a1a2e; transform: translateY(-2px); }
    .footer-contact-info p { font-size: 1.1em; margin-bottom: 12px; line-height: 1.7; color: #d0d0d0; }
    .footer-contact-info p a { color: #a0cff0; text-decoration: none; transition: color 0.3s ease; }
    .footer-contact-info p a:hover { color: #f9c74f; text-decoration: underline; }
    .footer-social-icons-new { margin-top: 20px; display: flex; gap: 15px; }
    .footer-social-icons-new a { display: inline-block; color: #e0e0e0; font-size: 1.8rem; transition: transform 0.3s ease, color 0.3s ease; }
    .footer-social-icons-new a:hover { transform: scale(1.15) translateY(-2px); color: #f9c74f; }
    .footer-social-icons-new .fa-instagram:hover { color: #E1306C; } .footer-social-icons-new .fa-youtube:hover { color: #FF0000; } .footer-social-icons-new .fa-facebook-f:hover { color: #1877F2; } .footer-social-icons-new .fa-twitter:hover { color: #1DA1F2; } .footer-social-icons-new .fa-linkedin-in:hover { color: #0A66C2; } .footer-social-icons-new .fa-whatsapp:hover { color: #25D366; }
    .footer-bottom-new { text-align: center; margin-top: 40px; padding-top: 25px; border-top: 1px solid #3a3a5e; font-size: 0.95em; color: #a0a0a0; }


    /* Styles for Diagram Section in Footer (from index.html) */
    .footer-diagram-feature { padding: 40px 20px; margin-bottom: 30px; border-bottom: 1px solid #2a2a4e; text-align: center; }
    .footer-diagram-title-wrapper { margin-bottom: 25px; display: inline-block; }
    .footer-diagram-title { background-color: var(--title-box-bg); border: 2px solid var(--title-box-border); border-radius: 12px; padding: 8px 35px; box-shadow: 0 0 8px rgba(0,0,0,0.4), inset 0 0 4px rgba(255,255,255,0.1), 0 0 12px var(--primary-glow-color); display: inline-block; }
    .footer-diagram-title h3 { font-family: 'Orbitron', sans-serif; font-size: 2em; color: var(--text-color); margin: 0; font-weight: 700; text-shadow: 0 0 4px var(--text-color), 0 0 8px var(--primary-glow-color); }
    .footer-diagram-area { width: 100%; max-width: 600px; margin: 0 auto 25px auto; position: relative; }
    #footer-tech-diagram-svg { width: 100%; height: auto; filter: drop-shadow(0 0 8px var(--primary-glow-color)); }
    .footer-diagram-tagline { font-size: 1em; line-height: 1.6; color: #bbb; margin-bottom: 30px; max-width: 450px; margin-left: auto; margin-right: auto; text-shadow: 0 0 4px rgba(0,0,0,0.6); }
    .footer-diagram-contact-button { display: inline-block; background-color: var(--button-blue); color: var(--text-color); padding: 10px 30px; border-radius: 25px; text-decoration: none; font-size: 1.1em; font-weight: 700; transition: all 0.3s ease; box-shadow: 0 0 8px var(--button-blue), 0 0 15px var(--button-blue); }
    .footer-diagram-contact-button:hover { background-color: #0056b3; box-shadow: 0 0 12px var(--button-blue), 0 0 25px var(--button-blue), inset 0 0 4px rgba(255,255,255,0.2); transform: translateY(-2px); }
    .svg-line { stroke: var(--primary-glow-color); stroke-width: 1.5; stroke-linecap: round; }
    .svg-node-dot { fill: var(--secondary-glow-color); }
    .svg-circle-bg { fill: #080c14e0; }
    .svg-circle-border { stroke: var(--primary-glow-color); stroke-width: 2; fill: none; }
    .svg-icon { fill: var(--medical-icon-color); filter: drop-shadow(0 0 3px var(--secondary-glow-color)); }
    .svg-text-main { font-family: 'Roboto', sans-serif; fill: var(--text-color); font-weight: 700; text-anchor: middle; dominant-baseline: middle; filter: drop-shadow(0 0 5px var(--primary-glow-color)); }
    .svg-text-arrows { fill: var(--secondary-glow-color); font-size: 1.5em; text-anchor: middle; dominant-baseline: middle; }


    /* Responsive Adjustments (from index.html) */
    @media (max-width: 768px) {
        .container { margin-top: 70px; padding: 15px; }
        section h2, .about-fest-content .center-reveal-title { font-size: 2rem; } /* Applied to new class name */
        .about-fest-content .center-reveal-desc { font-size: 1rem; } /* Applied to new class name */
        #matrix-countdown { gap: 15px; }
        .circle { width: 90px; height: 90px; }
        .count { font-size: 2rem; }
        .label { font-size: 0.8rem; }
        .matrix-caption { font-size: 1.1rem; }
        .footer-diagram-title h3 {font-size: 1.8em;}
        .footer-diagram-area { max-width: 90%; }
        .footer-container-new { grid-template-columns: 1fr; text-align: center; }
        .footer-heading-new { padding-left: 0; justify-content: center; }
        .footer-heading-new::before { left: 50%; transform: translateX(-50%) translateY(-50%); }
        .footer-quick-links-list, .footer-social-icons-new { justify-content: center; }

        /* Existing events.html media queries */
        main.container { margin-top: 80px; }
        h1.page-title { font-size: 2.5rem; }
        .filter-button { padding: 6px 12px; font-size: 0.8rem; }
        .event-modal-content { width: 95%; padding: 20px; max-height: 90vh; overflow-y: auto;}
    }
    @media (max-width: 600px) {
        .logo { font-size: 2.2rem; }
        header { padding: 10px 15px;}
        .container { margin-top: 60px; }
        section h2, .about-fest-content .center-reveal-title { font-size: 1.8rem; } /* Applied to new class name */
        #about-fest { height: auto; min-height: 60vh; } /* Adjusted video section on mobile */
        .about-fest-content { width: 100%; padding: 20px 15px; } /* Applied to new class name */
        .center-reveal-desc { font-size: 0.9rem; }
        #matrix-countdown { gap: 10px; }
        .circle { width: 70px; height: 70px; border-width: 2px; }
        .count { font-size: 1.4rem; }
        .label { font-size: 0.7rem; }
        .matrix-caption { font-size: 1rem; width: 95vw; }
        .footer-diagram-title h3 {font-size: 1.5em;}
        .footer-diagram-tagline {font-size: 0.9em;}
        .footer-diagram-contact-button {font-size: 1em; padding: 8px 25px;}
        #testimonials h2 { font-size: 1.8rem; }
        .testimonial-slide { padding: 18px 15px; }
        .testimonial-photo { width: 60px; height: 60px; margin-bottom: 12px; }
        .testimonial-name { font-size: 1rem; }
        .testimonial-text { font-size: 0.9rem; }
        .footer-quick-links-list li a { font-size: 1em; padding: 10px 18px; }

        /* Existing events.html media queries */
        h1.page-title { font-size: 2rem; }
        .filter-button { margin: 3px; }
        .footer-section { flex: 1 1 100%; text-align: center; }
        .footer-heading-new { padding-left: 0; justify-content: center; }
        .footer-heading-new::before { left: 50%; transform: translateX(-50%) translateY(-50%); }
        .footer-quick-links-list, .footer-social-icons-new { justify-content: center; }
        .version-tag { font-size: 2.5rem; }
        .event-title { font-size: 1.4rem; }
        .modal-title { font-size: 1.5rem; }
    }

</style>
</head>
<body>

<svg style="display: none;">
    <defs>
        <symbol id="icon-stethoscope" viewBox="0 0 24 24"><path d="M18 3H6c-1.1 0-2 .9-2 2v1H2.5C2.22 6 2 6.22 2 6.5S2.22 7 2.5 7H4v1c0 2.56 1.67 4.72 4 5.66V17H6.5c-.28 0-.5.22-.5.5s.22.5.5.5H8v1.5c0 .28.22.5.5.5s.5-.22.5-.5V18h1v-1.5c0-.98.46-1.85 1.2-2.42.4-.31.87-.58 1.4-.76.4-.14.78-.31 1.13-.51.4-.22.75-.48 1.06-.78.47-.47.81-1.04.99-1.65.04-.15.06-.3.06-.45V6c0-1.1-.9-2-2-2zm-2 3v.09c0 .43-.17.84-.47 1.15-.3.3-.7.46-1.12.46H9.59c-.42 0-.82-.16-1.12-.46-.3-.3-.47-.72-.47-1.15V6h8zm-3.5 10.5c-.28 0-.5.22-.5.5s.22.5.5.5h1.5c.28 0 .5-.22.5-.5s-.22-.5-.5-.5h-1.5zM6 9.22C5.07 8.7 4.42 7.77 4.16 6.69 4.06 6.28 4 5.87 4 5.46V5h12v.46c0 .41-.06.82-.16 1.23-.26 1.08-.91 2.01-1.84 2.53-.47.26-.88.6-1.21.99L12 11l-.79-.78c-.33-.39-.74-.73-1.21-.99z"/></symbol>
        <symbol id="icon-heart-pulse" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35zM7.5 5C5.52 5 4 6.52 4 8.5c0 2.72 2.65 5.2 6.55 8.58L12 18.17l1.45-1.09C17.35 13.7 20 11.22 20 8.5c0-1.98-1.52-3.5-3.5-3.5-1.74 0-3.41.81-4.5 2.09C10.91 5.81 9.24 5 7.5 5zm13.21-1.21L19.5 5l-1.71 1.71-1.21-1.21-1.21 1.21L14.17 5l-1.21 1.21-1.21-1.21-1.21 1.21-1.21-1.21L6.5 5 4.79 3.79 3.58 5l1.21 1.21 1.21-1.21L7.17 5l1.21 1.21 1.21-1.21 1.21 1.21 1.21-1.21L13.5 5l1.71 1.71 1.21-1.21 1.21 1.21 1.71-1.71z"/></symbol>
        <symbol id="icon-dna-helix" viewBox="0 0 24 24"><path d="M14.5 4c1.08 0 1.96.92 1.96 2.05 0 .2-.04.39-.09.58l-1.4 5.37h.01c.7-.62 1.12-1.51 1.12-2.5 0-1.77-1.31-3.22-3-3.46V4m-5 0v2.04c-1.69.24-3 1.69-3 3.46 0 .99.42 1.88 1.12 2.5h.01L6.63 6.63c-.05-.19-.09-.38-.09-.58C6.54 4.92 7.42 4 8.5 4M12 9c.83 0 1.5.67 1.5 1.5S12.83 12 12 12s-1.5-.67-1.5-1.5S11.17 9 12 9m2.5 6c-1.08 0-1.96-.92-1.96-2.05 0-.2.04-.39.09-.58l1.4-5.37h-.01c-.7.62-1.12 1.51-1.12 2.5 0 1.77 1.31 3.22 3 3.46V15m-5 0v-2.04c1.69-.24 3-1.69 3-3.46 0-.99-.42-1.88-1.12-2.5h-.01l1.41 5.37c.05.19.09.38.09.58 0 1.13-.88 2.05-1.96 2.05M12 17c-.83 0-1.5-.67-1.5-1.5S11.17 14 12 14s1.5.67 1.5 1.5S12.83 17 12 17m0-10c.28 0 .5.22.5.5V9h-.02c-.93-.24-1.9-.24-2.96 0H9V7.5c0-.28.22-.5.5-.5h.58c.95 0 1.85-.14 2.67-.37l.08-.02c.05-.01.1-.01.16-.01zm0 8c-.28 0-.5-.22-.5-.5V15h.02c.93.24 1.9.24 2.96 0H15v1.5c0 .28-.22.5-.5.5h-.58c-.95 0-1.85.14-2.67.37l-.08.02c-.05.01-.1.01-.16-.01z"/></symbol>
        <symbol id="icon-microscope" viewBox="0 0 24 24"><path d="M16.5 6c-1.08 0-2 .92-2 2.05V10h-1V8.05c0-1.13-.92-2.05-2-2.05H10V3H8v3H6.5c-1.13 0-2.05.92-2.05 2.05V10H3v2h1.45V10c0-.64.29-1.21.76-1.6.47-.39 1.05-.6 1.69-.6H8v2h1V8.05c0-.64.29-1.21.76-1.6.47-.39 1.05-.6 1.69-.6h1.05v1.95H13v-2h1.5c.64 0 1.22.21 1.69.6.47.39.76.96.76 1.6V12h1.45v-2H16.5V8.05C16.5 6.92 15.58 6 14.5 6h-2c-1.08 0-2 .92-2 2.05V10h-1V8.05c0-1.13-.92-2.05-2-2.05S6.5 6.92 6.5 8.05V10H3v2h1.45V10A2.5 2.5 0 016.5 7.5H8v2h1V7.5A2.5 2.5 0 0111.5 5h1A2.5 2.5 0 0115 7.5V10h1.45v-2H16.5V8.05A2.5 2.5 0 0014.5 6M12 13c-1.93 0-3.5 1.57-3.5 3.5V21h7v-4.5c0-1.93-1.57-3.5-3.5-3.5zm0 1c1.38 0 2.5 1.12 2.5 2.5V20h-5v-3.5c0-1.38 1.12-2.5 2.5-2.5z"/></symbol>
        <symbol id="icon-rod-of-asclepius" viewBox="0 0 24 24"><path d="M13.82 5.32c-.93-.89-2.18-1.32-3.48-1.32s-2.55.43-3.48 1.32C6 6.21 5.61 7.42 5.61 8.77c0 1.35.39 2.56 1.28 3.45.93.89 2.18 1.32 3.48 1.32s2.55-.43 3.48-1.32c.89-.89 1.28-2.1 1.28-3.45 0-1.35-.39-2.56-1.28-3.45M10.34 12c-1.31 0-2.4-.48-3.17-1.29-.77-.81-1.17-1.85-1.17-3.04 0-1.19.4-2.23 1.17-3.04.77-.81 1.86-1.29 3.17-1.29 1.31 0 2.4.48 3.17 1.29.77.81 1.17 1.85 1.17 3.04 0 1.19-.4 2.23-1.17 3.04-.77.81-1.86 1.29-3.17 1.29m.16 1.5c.34 0 .67.03.99.08v.02c.69.1 1.35.31 1.95.61l.01.01c.29.15.57.32.83.51l.01.01c.22.16.43.34.62.53l.01.01c.14.14.27.29.39.45l.01.01c.09.12.17.24.24.37.2.35.35.73.43 1.13l.01.06v.01c.04.22.06.44.06.67v2.09c0 .28-.22.5-.5.5h-1c-.28 0-.5-.22-.5-.5v-1.88c0-.47-.15-.92-.43-1.28-.1-.13-.21-.25-.33-.36-.18-.17-.38-.32-.6-.45-.29-.18-.6-.33-.93-.45-.48-.18-1-.29-1.53-.33h-.01c-.18-.01-.36-.02-.54-.02s-.36.01-.54.02h-.01c-.53.04-1.05.15-1.53.33-.33.12-.64.27-.93.45-.22.13-.42.28-.6.45-.12.11-.23.23-.33.36-.28.36-.43.81-.43 1.28v1.88c0 .28-.22.5-.5.5h-1c-.28 0-.5-.22-.5-.5v-2.09c0-.23.02-.45.06-.67v-.01l.01-.06c.08-.4.23-.78.43-1.13.07-.13.15-.25.24-.37l.01-.01c.12-.16.25-.31.39-.45l.01-.01c.19-.19.4-.37.62-.53l.01-.01c.26-.19.54-.36.83-.51l.01-.01c.6-.3 1.26-.51 1.95-.61v-.02c.32-.05.65-.08.99-.08z"/></symbol>
        <symbol id="icon-brain" viewBox="0 0 24 24"><path d="M12 2C9.46 2 7.24 3.22 6 5.06c-1.01 1.52-1.59 3.29-1.59 5.11S4.99 13.67 6 15.2c.47.6 1.02 1.12 1.63 1.56.04.03.09.06.13.09C8.32 17.27 9 17.58 9 18.22V19c0 .94.44 1.79 1.15 2.36.05.04.1.08.15.12.72.54 1.79.62 2.7.62.91 0 1.98-.08 2.7-.62.05-.04.1-.08.15-.12.71-.57 1.15-1.42 1.15-2.36v-.78c0-.64.68-.95 1.24-1.37.04-.03.09-.06.13-.09.61-.44 1.16-.96 1.63-1.56 1.01-1.52 1.59-3.29 1.59-5.11S19.01 6.58 18 5.06C16.76 3.22 14.54 2 12 2m4.1 13.6c-.3.35-.65.66-1.02.93-.05.04-.1.07-.15.1-.73.53-1.13 1.28-1.13 2.15v.72c0 .41-.17.78-.45 1.04-.03.02-.06.04-.09.06-.37.28-.9.4-1.36.4s-.99-.12-1.36-.4c-.03-.02-.06-.04-.09-.06-.28-.26-.45-.63-.45-1.04v-.72c0-.87-.4-1.62-1.13-2.15-.05-.03-.1-.06-.15-.1-.37-.26-.72-.58-1.02-.93C7.21 14.07 7 12.87 7 11.63c0-1.29.28-2.55.82-3.66.44-.92 1.07-1.72 1.86-2.37.6-.48 1.29-.8 2.03-.95.73-.15 1.48-.15 2.21 0 .75.15 1.43.47 2.03.95.79.65 1.42 1.45 1.86 2.37.54 1.11.82 2.37.82 3.66 0 1.24-.21 2.44-.6 3.47m-2.1-5.1c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5c0 .46.21.88.55 1.16-.48.24-.8.75-.8 1.34 0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5c0-.59-.32-1.1-.8-1.34.34-.28.55-.7.55-1.16m-4 0c0-.83-.67-1.5-1.5-1.5S9 9.67 9 10.5c0 .46.21.88.55 1.16-.48.24-.8.75-.8 1.34 0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5c0-.59-.32-1.1-.8-1.34.34-.28.55-.7.55-1.16z"/></symbol>
        <symbol id="icon-medical-plus" viewBox="0 0 24 24"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></symbol>
        <symbol id="icon-atom" viewBox="0 0 24 24"><path d="M12 2c-2.36 0-4.48.77-6.23 2.11l1.01 1.74C8.04 4.79 9.92 4 12 4s3.96.79 5.22 1.85l1.01-1.74C16.48 2.77 14.36 2 12 2m0 16c-2.08 0-3.96-.79-5.22-1.85l-1.01 1.74c1.75 1.34 3.87 2.11 6.23 2.11s4.48-.77 6.23-2.11l-1.01-1.74c-1.26 1.06-3.14 1.85-5.22 1.85M5.92 7.32C4.79 8.58 4 10.27 4 12s.79 3.42 1.92 4.68l1.74-1.01C6.79 14.4 6 13.29 6 12s.79-2.4 1.66-3.67l-1.74-1.01M18.08 7.32l-1.74 1.01C17.21 9.6 18 10.71 18 12s-.79 2.4-1.66 3.67l1.74 1.01C19.21 15.42 20 13.73 20 12s-.79-3.42-1.92-4.68M12 7a5 5 0 100 10 5 5 0 000-10m0 2a3 3 0 110 6 3 3 0 010-6z"/></symbol>
        <symbol id="icon-test-tube" viewBox="0 0 24 24"><path d="M7 2v11.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V6h2v9.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V2H7zm10 0v2h-2V2h2zm-2 4h2v2h-2V6zm2 4h-2v2h2v-2zM6 19c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm8-13.22L12.78 7H14v1h-2.22L10.56 9H12v1h-2.44L8.34 11H10v1H8v1h1.78l1.22 1H18V2h-4v3.78zM16 11h-1.11l-.89-1H16v1zm0-2h-2.22l-.89-1H16v1zm0-2h-3.33l-.89-1H16v1z"/></symbol>
        <symbol id="icon-sparkle" viewBox="0 0 24 24"><path d="M12 2l1.5 4.5h4.5l-3.5 3 1.5 5-4.5-3.5-4.5 3.5 1.5-5-3.5-3h4.5L12 2z"/></symbol>
        <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
            <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
            <feMerge> <feMergeNode in="coloredBlur"/> <feMergeNode in="SourceGraphic"/> </feMerge>
        </filter>
    </defs>
</svg>


<header class="visible">
    <a href="index.html" class="logo">CEREBREXIA</a>
    <button class="new-menu-toggle-button" id="newMenuToggleButton" aria-label="Open navigation menu" aria-expanded="false">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</header>

<div id="fullScreenNav">
    <button class="nav-close-btn" id="navCloseButton" aria-label="Close navigation menu">×</button>
    <ul>
        <li><a href="index.html">HOME</a></li>
        <li><a href="events.html" class="active-nav-link">EVENTS</a></li>
        <li><a href="pronite.html">PRONITES</a></li>
        <li><a href="register.html">REGISTER</a></li>
        <li><a href="merch.html">MERCHANDISE</a></li>
        <li><a href="accommodation.html">ACCOMMODATION</a></li>
        <li><a href="schedule.html">SCHEDULE</a></li>
        <li><a href="profile.html">PROFILE</a></li>
    </ul>
</div>


<main class="container" data-aos="fade-up" data-aos-duration="1200">
    <h1 class="page-title">EVENTS AT CEREBREXIA'25</h1>

    <div class="filter-container" data-aos="fade-up" data-aos-delay="200">
        <div class="filter-group">
            <label>Event Categories:</label>
            <button class="filter-button active" data-category="All">All</button>
            <button class="filter-button" data-category="Pro-Events">Pro-Events</button>
            <button class="filter-button" data-category="Athletics">Athletics</button>
            <button class="filter-button" data-category="Literary">Literary</button>
            <button class="filter-button" data-category="Cultural">Cultural</button>
            <button class="filter-button" data-category="Arts">Arts</button>
            <button class="filter-button" data-category="Informals">Informals</button>
            <button class="filter-button" data-category="Academics">Academics</button>
            <button class="filter-button" data-category="Sports">Sports</button>
        </div>
        <div class="filter-group" id="subCategoryFilters">
            <label>Sub-Category:</label>
            <button class="filter-button active" data-subcategory="All">All</button>
        </div>
    </div>

    <div class="events-grid">
    </div>
</main>

<div id="eventRegistrationModal" class="event-modal">
    <div class="event-modal-content">
        <span class="event-modal-close" id="closeModalButton" aria-label="Close registration form">×</span>
        <h2 id="modalEventTitle" class="text-2xl md:text-3xl font-bold mb-1 modal-title">Register for Event</h2>
        <p id="modalEventFee" class="text-lg mb-6 modal-event-fee">Registration Fee: N/A</p>

        <form id="eventRegForm" class="modal-form">
            <input type="hidden" id="formEventId" name="eventId">
            <input type="hidden" id="formEventName" name="eventName">
            <input type="hidden" id="formEventFeeValue" name="eventFeeValue">
            <input type="hidden" id="formCoordinatorEmail" name="coordinatorEmail">
            <input type="hidden" id="formIsTeamEvent" name="isTeamEvent">


            <div class="form-group">
                <label for="regFullName">Full Name (Team Leader for Group Events) <span class="text-red-500">*</span></label>
                <input type="text" id="regFullName" name="fullName" placeholder="Enter your full name" required>
            </div>
            <div class="grid md:grid-cols-2 gap-4">
                <div class="form-group">
                    <label for="regEmail">Email Address (Team Leader) <span class="text-red-500">*</span></label>
                    <input type="email" id="regEmail" name="email" placeholder="your.email@example.com" required>
                </div>
                <div class="form-group">
                    <label for="regPhone">Contact Number (Team Leader, WhatsApp) <span class="text-red-500">*</span></label>
                    <input type="tel" id="regPhone" name="phone" placeholder="+91 XXXXXXXXXX" required>
                </div>
            </div>
            <div class="grid md:grid-cols-2 gap-4">
                <div class="form-group">
                    <label for="regCollegeName">College Name (Team Leader) <span class="text-red-500">*</span></label>
                    <input type="text" id="regCollegeName" name="collegeName" placeholder="Your college/university" required>
                </div>
                <div class="form-group">
                    <label for="regYearOfStudy">Year of Study (Team Leader) <span class="text-red-500">*</span></label>
                    <select id="regYearOfStudy" name="yearOfStudy" required>
                        <option value="">Select Year</option>
                        <option value="1st Year">1st Year</option>
                        <option value="2nd Year">2nd Year</option>
                        <option value="3rd Year">3rd Year</option>
                        <option value="4th Year">4th Year</option>
                        <option value="5th Year / Final Year">5th Year / Final Year</option>
                        <option value="Faculty">Faculty</option>
                        <option value="Alumni">Alumni</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
            </div>

            <div id="teamFieldsContainer" class="hidden-field">
                <div class="grid md:grid-cols-2 gap-4">
                        <div class="form-group">
                            <label for="regTeamName">Team Name <span class="text-red-500">*</span></label>
                            <input type="text" id="regTeamName" name="teamName" placeholder="Enter team name (if applicable)">
                        </div>
                        <div class="form-group">
                            <label for="regTeamMembersCount">Number of Team Members (including self) <span class="text-red-500">*</span></label>
                            <input type="number" id="regTeamMembersCount" name="teamMembersCount" min="1" placeholder="e.g., 3 (if team event)">
                        </div>
                </div>
                <div id="groupMemberDetailsContainer" class="mt-3">
                        </div>
            </div>

            <div id="submissionLinkContainer" class="form-group hidden-field">
                <label for="regSubmissionLink">Submission Link (Drive, GitHub, YouTube, etc.)</label>
                <input type="url" id="regSubmissionLink" name="submissionLink" placeholder="https://your-submission-link.com">
                <p class="text-xs text-gray-400 mt-1">For online events requiring submission. Ensure link is accessible.</p>
            </div>

            <div class="form-group">
                <label for="regPurpose">Brief Note / Query (Optional)</label>
                <textarea id="regPurpose" name="purpose" rows="3" placeholder="e.g., Specific query about the event, or why you are excited to participate!"></textarea>
            </div>
            <div class="form-group">
                <label for="regTerms" class="terms-label">
                    <input type="checkbox" id="regTerms" name="terms" required>
                    I have read and agree to the event rules and CEREBREXIA'25 guidelines. <span class="text-red-500">*</span>
                </label>
            </div>
            <button type="submit" id="modalSubmitButton" class="modal-submit-btn">Submit Entry</button>
        </form>
        <div id="formResponseMessage" class="mt-4 hidden"></div>
    </div>
</div>


<footer class="site-footer">
    <div class="footer-diagram-feature" data-aos="fade-up">
        <div class="footer-diagram-title-wrapper">
            <div class="footer-diagram-title">
                <h3>CEREBREXIA VERSE</h3>
            </div>
        </div>
        <div class="footer-diagram-area">
            <svg id="footer-tech-diagram-svg" viewBox="0 0 600 400" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                <line class="svg-line" x1="300" y1="200" x2="150" y2="80" /><line class="svg-line" x1="300" y1="200" x2="80" y2="200" /><line class="svg-line" x1="300" y1="200" x2="150" y2="320" /><line class="svg-line" x1="300" y1="200" x2="450" y2="80" /><line class="svg-line" x1="300" y1="200" x2="520" y2="200" /><line class="svg-line" x1="300" y1="200" x2="450" y2="320" /><line class="svg-line" x1="150" y1="80" x2="80" y2="200" /><line class="svg-line" x1="80" y1="200" x2="150" y2="320" /><line class="svg-line" x1="450" y1="80" x2="520" y2="200" /><line class="svg-line" x1="520" y1="200" x2="450" y2="320" /><line class="svg-line" x1="150" y1="80" x2="300" y2="50" /><line class="svg-line" x1="450" y1="80" x2="300" y2="50" /><line class="svg-line" x1="150" y1="320" x2="230" y2="360" /><line class="svg-line" x1="450" y1="320" x2="370" y2="360" />
                <circle class="svg-circle-bg" cx="300" cy="200" r="70"/><circle class="svg-circle-border" cx="300" cy="200" r="70" filter="url(#glow)"/><text class="svg-text-main" x="300" y="190" font-size="14px">CONNECTING</text><text class="svg-text-main" x="300" y="210" font-size="14px">MEDICS</text><text class="svg-text-arrows" x="300" y="155">⬆</text> <text class="svg-text-arrows" x="300" y="245">⬇</text><text class="svg-text-arrows" x="255" y="200">⬅</text> <text class="svg-text-arrows" x="345" y="200">➡</text><text class="svg-text-arrows" transform="translate(268 168) rotate(-45)" >↖</text><text class="svg-text-arrows" transform="translate(332 168) rotate(45)">↗</text><text class="svg-text-arrows" transform="translate(268 232) rotate(45)">↙</text><text class="svg-text-arrows" transform="translate(332 232) rotate(-45)">↘</text>
                <g transform="translate(150, 80)"><circle class="svg-circle-bg" r="35"/><circle class="svg-circle-border" r="35" filter="url(#glow)"/><use xlink:href="#icon-stethoscope" width="40" height="40" x="-20" y="-20" class="svg-icon"/></g>
                <g transform="translate(80, 200)"><circle class="svg-circle-bg" r="35"/><circle class="svg-circle-border" r="35" filter="url(#glow)"/><use xlink:href="#icon-heart-pulse" width="40" height="40" x="-20" y="-20" class="svg-icon"/></g>
                <g transform="translate(150, 320)"><circle class="svg-circle-bg" r="35"/><circle class="svg-circle-border" r="35" filter="url(#glow)"/><use xlink:href="#icon-dna-helix" width="38" height="38" x="-19" y="-19" class="svg-icon"/></g>
                <g transform="translate(450, 80)"><circle class="svg-circle-bg" r="35"/><circle class="svg-circle-border" r="35" filter="url(#glow)"/><use xlink:href="#icon-microscope" width="40" height="40" x="-20" y="-20" class="svg-icon"/></g>
                <g transform="translate(520, 200)"><circle class="svg-circle-bg" r="35"/><circle class="svg-circle-border" r="35" filter="url(#glow)"/><use xlink:href="#icon-rod-of-asclepius" width="38" height="38" x="-19" y="-19" class="svg-icon"/></g>
                <g transform="translate(450, 320)"><circle class="svg-circle-bg" r="35"/><circle class="svg-circle-border" r="35" filter="url(#glow)"/><use xlink:href="#icon-brain" width="40" height="40" x="-20" y="-20" class="svg-icon"/></g>
                <g transform="translate(300, 50)"><circle class="svg-circle-bg" r="25"/><circle class="svg-circle-border" r="25" filter="url(#glow)"/><use xlink:href="#icon-medical-plus" width="30" height="30" x="-15" y="-15" class="svg-icon"/></g>
                <g transform="translate(230, 360)"><circle class="svg-circle-bg" r="25"/><circle class="svg-circle-border" r="25" filter="url(#glow)"/><use xlink:href="#icon-atom" width="30" height="30" x="-15" y="-15" class="svg-icon"/></g>
                <g transform="translate(370, 360)"><circle class="svg-circle-bg" r="25"/><circle class="svg-circle-border" r="25" filter="url(#glow)"/><use xlink:href="#icon-test-tube" width="30" height="30" x="-15" y="-15" class="svg-icon"/></g>
                <g transform="translate(80, 120)"><circle class="svg-circle-bg" r="20"/><circle class="svg-circle-border" r="20" filter="url(#glow)"/><use xlink:href="#icon-sparkle" width="25" height="25" x="-12.5" y="-12.5" class="svg-icon"/></g>
                <g transform="translate(520, 120)"><circle class="svg-circle-bg" r="20"/><circle class="svg-circle-border" r="20" filter="url(#glow)"/><use xlink:href="#icon-sparkle" width="25" height="25" x="-12.5" y="-12.5" class="svg-icon"/></g>
                <circle class="svg-node-dot" cx="300" cy="200" r="3" filter="url(#glow)"/><circle class="svg-node-dot" cx="150" cy="80" r="3" filter="url(#glow)"/><circle class="svg-node-dot" cx="80" cy="200" r="3" filter="url(#glow)"/><circle class="svg-node-dot" cx="150" cy="320" r="3" filter="url(#glow)"/><circle class="svg-node-dot" cx="450" cy="80" r="3" filter="url(#glow)"/><circle class="svg-node-dot" cx="520" cy="200" r="3" filter="url(#glow)"/><circle class="svg-node-dot" cx="450" cy="320" r="3" filter="url(#glow)"/><circle class="svg-node-dot" cx="300" cy="50" r="3" filter="url(#glow)"/><circle class="svg-node-dot" cx="230" cy="360" r="3" filter="url(#glow)"/><circle class="svg-node-dot" cx="370" cy="360" r="3" filter="url(#glow)"/><circle class="svg-node-dot" cx="80" cy="120" r="3" filter="url(#glow)"/><circle class="svg-node-dot" cx="520" cy="120" r="3" filter="url(#glow)"/>
            </svg>
        </div>
        <p class="footer-diagram-tagline">
            Back again to make you guys vibe, Get stress free and enjoy the fest to its fullest
        </p>
        <a href="mailto:thecerebrexia17@gmail.com" class="footer-diagram-contact-button">CONTACT ORGANIZERS</a>
    </div>

    <div class="footer-container-new">
      <div class="footer-section-new">
        <h3 class="footer-heading-new">Connect</h3>
        <div class="footer-social-icons-new">
          <a href="https://facebook.com/cerebrexia" target="_blank" aria-label="Facebook" title="Facebook"><i class="fab fa-facebook-f"></i></a>
          <a href="https://www.instagram.com/igimsfest/" target="_blank" rel="noopener noreferrer" aria-label="Instagram" title="Instagram"><i class="fab fa-instagram"></i></a>
          <a href="https://twitter.com/cerebrexia" target="_blank" aria-label="Twitter" title="Twitter"><i class="fab fa-twitter"></i></a>
          <a href="https://linkedin.com/company/cerebrexia" target="_blank" aria-label="LinkedIn" title="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
          <a href="https://www.youtube.com/@cerebrexia" target="_blank" aria-label="YouTube" title="YouTube"><i class="fab fa-youtube"></i></a>
          <a href="https://whatsapp.com/channel/0029VbA0P20HbFV2ke5rlR2G" target="_blank" rel="noopener noreferrer" aria-label="WhatsApp Channel" title="WhatsApp Channel"><i class="fab fa-whatsapp"></i></a>
        </div>
            <p style="margin-top: 15px; font-size: 1em; color: #b0b0c0;">Stay connected for live updates!</p>
      </div>

      <div class="footer-section-new">
        <h3 class="footer-heading-new">Quick Links</h3>
        <ul class="footer-quick-links-list">
          <li><a href="index.html">Home</a></li>
          <li><a href="events.html">Events</a></li>
          <li><a href="schedule.html">Schedule</a></li>
          <li><a href="pronite.html">Pronites</a></li>
          <li><a href="#team">Team</a></li>
          <li><a href="accommodation.html">Accommodation</a></li>
          <li><a href="register.html">Delegate Registration</a></li>
          <li><a href="privacypolicy.html">Privacy Policy</a></li>
          <li><a href="terms.html">Terms of Service</a></li>
          <li><a href="codeofconduct.html">Code of Conduct</a></li>
        </ul>
      </div>

      <div class="footer-section-new">
        <h3 class="footer-heading-new">Contact</h3>
        <div class="footer-contact-info">
          <p>Email: <a href="mailto:info@cerebrexia25.com">info@cerebrexia25.com</a></p>
          <p>Pankaj Kumar: <a href="tel:+919079956283">+91 90799 56283</a></p>
          <p>Dhananjay Kumar: <a href="tel:+917425992291">+91 74259 92291</a></p>
          <p style="margin-top:15px;">IGIMS Patna Campus,<br/>Sheikhpura, Patna, Bihar - 800014</p>
        </div>
      </div>
    </div>
    <div class="footer-bottom-new">
      <p>© 2025 CEREBREXIA'25 - IGIMS Patna. All Rights Reserved. Designed with <i class="fas fa-heart" style="color: #ff00ff;"></i>.</p>
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>

<script>
    // --- Firebase Configuration ---
    const firebaseConfig = {
        apiKey: "AIzaSyBOWumY95hdMt2uOvmJEk5WG0GhdqUHUNc",
        authDomain: "cerebrexia-ee068.firebaseapp.com",
        projectId: "cerebrexia-ee068",
        storageBucket: "cerebrexia-ee068.appspot.com",
        messagingSenderId: "328864114758",
        appId: "1:328864114758:web:108968f6576b6967f14247",
        measurementId: "G-6Z6EP1ZTEJ"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth(); // Initialize Auth for user context
    const db = firebase.firestore();

    // --- DOM Elements ---
    const eventsGrid = document.querySelector('.events-grid');
    const modal = document.getElementById('eventRegistrationModal');
    const closeModalButton = document.getElementById('closeModalButton');
    const eventRegForm = document.getElementById('eventRegForm');
    const modalEventTitle = document.getElementById('modalEventTitle');
    const modalEventFee = document.getElementById('modalEventFee');

    const formEventIdInput = document.getElementById('formEventId');
    const formEventNameInput = document.getElementById('formEventName');
    const formEventFeeValueInput = document.getElementById('formEventFeeValue');
    const formCoordinatorEmailInput = document.getElementById('formCoordinatorEmail');
    const formIsTeamEventInput = document.getElementById('formIsTeamEvent');

    const formResponseMessage = document.getElementById('formResponseMessage');
    const modalSubmitButton = document.getElementById('modalSubmitButton');

    const teamFieldsContainer = document.getElementById('teamFieldsContainer');
    const regTeamNameInput = document.getElementById('regTeamName');
    const regTeamMembersCountInput = document.getElementById('regTeamMembersCount');
    const groupMemberDetailsContainer = document.getElementById('groupMemberDetailsContainer');
    const submissionLinkContainer = document.getElementById('submissionLinkContainer');
    const regSubmissionLinkInput = document.getElementById('regSubmissionLink');

    const regFullName = document.getElementById('regFullName');
    const regEmail = document.getElementById('regEmail');
    const regPhone = document.getElementById('regPhone');
    const regCollegeName = document.getElementById('regCollegeName');
    const regYearOfStudy = document.getElementById('regYearOfStudy');

    let currentEvent = null; // To store the event object when modal is open
    let currentUser = null; // To store Firebase authenticated user

    // --- Data (Event List) ---
    const eventsData = [
        // --- Cultural Events ---
        { id: 1, category: 'Cultural', subCategory: 'Dance', title: 'Rhythmic Rhapsody (Group Dance)', shortDescription: 'Synchronized moves and captivating choreography.', longDescription: 'Ignite the stage! Open-style group dance competition. Judged on coordination, creativity, stage presence, and time adherence. Any dance form welcome.', rules: ['Team: 4-12 members.','Duration: 5-8 mins (entry/exit incl.).','Props: Allowed, pre-approved, self-managed. No hazardous items.','Music: Submit MP3/link 2 days prior.'], prizes: 'Cash, Trophies, Workshop Scholarships.', contact: 'Anjali D. (Cultural Secretary)', image: 'https://placehold.co/600x400/8e44ad/ffffff?text=Rhythmic+Rhapsody&font=exo', date: 'Upcoming: 15th Dec 2025', regFee: '₹500 / Team', isTeamEvent: true, requiresSubmission: false, coordinatorEmail: 'cultural.lead@cerebrexia.com', teamSize: {min: 4, max: 12} },
        { id: 2, category: 'Cultural', subCategory: 'Music', title: 'Sonic Showdown (Battle of Bands)', shortDescription: 'Rock the stage, original compositions encouraged.', longDescription: 'High-octane band competition. Judged on originality, stage presence, musicality, crowd engagement. Strict setup time.', rules: ['Team: 3-7 members.','Slot: 15 mins (incl. setup/soundcheck).','Originals encouraged; covers credited & distinct.','No offensive lyrics/gestures.'], prizes: 'Cash, Studio Time, Pronite Opening Slot.', contact: 'Rohan S. (Music Club Head)', image: 'https://placehold.co/600x400/c0392b/ffffff?text=Sonic+Showdown&font=exo', date: 'Upcoming: 15th Dec 2025', regFee: '₹800 / Band', isTeamEvent: true, requiresSubmission: false, coordinatorEmail: 'music.lead@cerebrexia.com', teamSize: {min: 3, max: 7} },
        { id: 3, category: 'Cultural', subCategory: 'Fashion', title: 'Cyber Glitz (Fashion Show)', shortDescription: 'Futuristic styles meet ramp elegance.', longDescription: 'Theme: "Cyber Glitz - Where Future Meets Fashion". Showcase innovative designs. Professional choreographers will guide.', rules: ['Solo or Group (max 5 models).','Design outfits for "Cyber Glitz" theme.','Judged on creativity, confidence, theme adherence, ramp walk.'], prizes: 'Internships, Photoshoots, Vouchers.', contact: 'Priya S. (Fashion Lead)', image: 'https://placehold.co/600x400/2980b9/ffffff?text=Cyber+Glitz+Runway&font=exo', date: 'Upcoming: 16th Dec 2025', regFee: '₹300 / Solo, ₹600 / Group', isTeamEvent: true, requiresSubmission: false, coordinatorEmail: 'fashion.lead@cerebrexia.com', teamSize: {min: 1, max: 5} },
        { id: 5, category: 'Cultural', subCategory: 'Music', title: 'Vocal Vortex (Solo Singing)', shortDescription: 'Mesmerize with your solo vocal talent.', longDescription: 'Capture hearts with your voice! Any genre. Karaoke or own instrument. Professional sound setup provided.', rules: ['Duration: 3-5 minutes.','Submit karaoke (MP3) or bring instrument.','Judged on pitch, rhythm, range, emotion, presence.'], prizes: 'Recording Audition, Cash, Instruments.', contact: 'Sneha R. (Vocals Lead)', image: 'https://placehold.co/600x400/f39c12/ffffff?text=Vocal+Vortex&font=exo', date: 'Upcoming: 17th Dec 2025', regFee: '₹200 / Solo', isTeamEvent: false, requiresSubmission: false, coordinatorEmail: 'music.lead@cerebrexia.com' },
        { id: 20, category: 'Cultural', subCategory: 'Performing Arts', title: 'Nukkad Natak (Street Play)', shortDescription: 'Powerful street theatre on social themes.', longDescription: 'Bring social awareness to the forefront. No stage, raw talent, impactful message. Themes: Environment, Mental Health, Gender Equality.', rules: ['Team: 5-10 members.','Duration: 15-20 minutes.','Themes provided.','No mics/elaborate props. Focus on voice/body language.'], prizes: 'Social Message Award, Cash, Community Performance Opps.', contact: 'Cultural Committee Head', image: 'https://placehold.co/600x400/16a085/ffffff?text=Street+Impact+Play&font=exo', date: 'Upcoming: 17th Dec 2025', regFee: '₹100 / Team', isTeamEvent: true, requiresSubmission: false, coordinatorEmail: 'cultural.lead@cerebrexia.com', teamSize: {min:5, max:10} },
        // --- Literary Events ---
        { id: 4, category: 'Literary', subCategory: 'Quiz', title: 'Quiztopia: The Omega Challenge', shortDescription: 'Battle of wits across diverse topics.', longDescription: 'Multi-round quiz: GK, Current Affairs, STEM, Arts, Sports. Challenging questions, buzzer rounds.', rules: ['Team: 2-3 members. Cross-college allowed.','Rounds: Rapid fire, AV, Buzzer.','No electronic devices. Cheating = disqualification.'], prizes: 'Cash, Software Licenses, Champions Title.', contact: 'Akash K. (Quiz Master)', image: 'https://placehold.co/600x400/27ae60/ffffff?text=Quiztopia+Challenge&font=exo', date: 'Upcoming: 16th Dec 2025', regFee: '₹200 / Team', isTeamEvent: true, requiresSubmission: false, coordinatorEmail: 'literary.lead@cerebrexia.com', teamSize: {min:2, max:3} },
        { id: 8, category: 'Literary', subCategory: 'Debate', title: 'Orator\'s Odyssey (Debate Championship)', shortDescription: 'Articulate views in a battle of wits.', longDescription: 'Test rhetorical skills. Critical thinking, compelling arguments, persuasive delivery. British Parliamentary format in later rounds.', rules: ['Individual participation. Prelims may be paired.','Multiple rounds (extempore, prepared).','Topics: 24hrs prior (prepared) / on-spot (extempore).','Strict time limits.'], prizes: 'Cash, National Debate Opps, Workshops.', contact: 'Shreya J. (Debate Society)', image: 'https://placehold.co/600x400/34495e/ffffff?text=Orator%27s+Odyssey&font=exo', date: 'Upcoming: 17th Dec 2025', regFee: '₹150 / Solo', isTeamEvent: false, requiresSubmission: false, coordinatorEmail: 'literary.lead@cerebrexia.com' },
        { id: 21, category: 'Literary', subCategory: 'Poetry', title: 'Verse Vanguard (Poetry Slam)', shortDescription: 'Spoken word poetry at its finest.', longDescription: 'Dynamic poetry competition. Original work. Judged on content, originality, delivery, stage presence. All languages/styles welcome.', rules: ['Individual participation.','3 minutes per round.','Original work only. No props, costumes, music.','Respectful & inclusive content.'], prizes: 'Cash, Publication Opps, Mentorship.', contact: 'Literary Society Head', image: 'https://placehold.co/600x400/9b59b6/ffffff?text=Verse+Vanguard+Slam&font=exo', date: 'Upcoming: 16th Dec 2025', regFee: '₹100 / Solo', isTeamEvent: false, requiresSubmission: false, coordinatorEmail: 'literary.lead@cerebrexia.com' },
        { id: 26, category: 'Literary', subCategory: 'Writing', title: 'Script Scape (Short Story/Script Writing)', shortDescription: 'Weave compelling narratives. Online submission.', longDescription: 'Craft a captivating short story (1500-2000 words) or a short film script (10-15 pages) on the theme "Echoes of Tomorrow". Submit online.', rules: ['Individual participation.','Original, unpublished work.','Adhere to word/page limits.','Format: PDF. Font: Times New Roman, 12pt.'], prizes: 'Cash, Publication in Fest Zine, Writing Workshop.', contact: 'Creative Writing Club', image: 'https://placehold.co/600x400/7f8c8d/ffffff?text=Script+Scape+Contest&font=exo', date: 'Upcoming Submission (Deadline: 10th Dec 2025)', regFee: 'Free', isTeamEvent: false, requiresSubmission: true, coordinatorEmail: 'literary.lead@cerebrexia.com' },
        // --- Academics Events ---
        { id: 7, category: 'Academics', subCategory: 'Tech', title: 'InnovateX (Tech Innovation Challenge)', shortDescription: 'Develop innovative tech solutions.', longDescription: 'Propose tech solutions for healthcare, environment, education, or social impact. Present prototype/design. Judged by industry/academia experts.', rules: ['Team: 2-4. Inter-disciplinary encouraged.','Submit concept note (max 500 words) by 5th Dec.','Final presentation (10 mins) with prototype/demo.','Judged on innovation, feasibility, impact, presentation.'], prizes: 'Incubation Support, Seed Funding, Gadgets, Mentorship.', contact: 'Prof. Ananya D. (CSE Dept)', image: 'https://placehold.co/600x400/1abc9c/ffffff?text=InnovateX+Challenge&font=exo', date: 'Upcoming: 18th Dec 2025', regFee: '₹600 / Team', isTeamEvent: true, requiresSubmission: true, coordinatorEmail: 'academics.lead@cerebrexia.com', teamSize: {min:2, max:4} },
        { id: 11, category: 'Academics', subCategory: 'Tech', title: 'Robo Genesis (Workshop & Competition)', shortDescription: 'Build, program, and battle robots!', longDescription: 'Hands-on robotics workshop, then compete with self-built robots. No prior experience needed, materials provided during workshop.', rules: ['Team: 2-3 members.','Workshop attendance mandatory for competition.','Competition rules provided at workshop.','Judged on design, programming, performance.'], prizes: 'Robotics Kits, Course Scholarships, Internships.', contact: 'Dr. Kavita S. (Robotics Club)', image: 'https://placehold.co/600x400/2ecc71/ffffff?text=Robo+Genesis+Arena&font=exo', date: 'Upcoming: 16th-17th Dec 2025', regFee: '₹1000 / Team (Incl. Workshop)', isTeamEvent: true, requiresSubmission: false, coordinatorEmail: 'academics.lead@cerebrexia.com', teamSize: {min:2, max:3}},
        { id: 18, category: 'Academics', subCategory: 'Tech', title: 'AI Frontier (Code-a-thon)', shortDescription: '24-hour AI solutions hackathon.', longDescription: 'Push AI boundaries. Develop innovative AI solutions. Mentors from tech companies. Focus: Healthcare AI, Enviro-Tech, Smart Cities.', rules: ['Team: 2-4. AI/ML experience recommended.','Problem statements revealed at start.','Bring own laptops/dev environment.','Judged on innovation, complexity, feasibility, presentation.'], prizes: 'Cash, Internships, Cloud Credits, HPC Access.', contact: 'Prof. Ananya D. (CSE Dept)', image: 'https://placehold.co/600x400/3498db/ffffff?text=AI+Frontier+Hack&font=exo', date: 'Upcoming: 17th-18th Dec 2025', regFee: '₹800 / Team', isTeamEvent: true, requiresSubmission: true, coordinatorEmail: 'academics.lead@cerebrexia.com', teamSize: {min:2, max:4}},
        { id: 23, category: 'Academics', subCategory: 'Medical', title: 'Diagnosis Duel (Med-Quiz)', shortDescription: 'High-intensity medical knowledge quiz.', longDescription: 'Specialized quiz for medical/allied health students. Topics: Anatomy, Physiology, Pharmacology, Pathology, Clinical Scenarios.', rules: ['Team: 2-3 members.','Rounds: Clinical cases, image recognition, rapid fire.','Open to all medical/paramedical course years.','No external resources during quiz.'], prizes: 'Medical Textbooks, Online Resource Subscriptions, Cash.', contact: 'Student Medical Council', image: 'https://placehold.co/600x400/e74c3c/ffffff?text=Diagnosis+Duel+Quiz&font=exo', date: 'Upcoming: 17th Dec 2025', regFee: '₹300 / Team', isTeamEvent: true, requiresSubmission: false, coordinatorEmail: 'medical.quiz@cerebrexia.com', teamSize: {min:2, max:3}},
        { id: 28, category: 'Academics', subCategory: 'Business', title: 'Case Crunch (Case Study Competition)', shortDescription: 'Solve real-world business challenges.', longDescription: 'Dive into complex business scenarios. Analyze, strategize, and present your solutions to a panel of industry experts. Cases will be from diverse sectors.', rules: ['Team: 2-4 members.','Case released 48 hours before presentation.','Presentation: 15 mins + 10 mins Q&A.','Judged on analytical depth, solution creativity, and presentation clarity.'], prizes: 'Cash Prizes, Internship Opportunities, Networking.', contact: 'MBA Club Coordinator', image: 'https://placehold.co/600x400/f39c12/ffffff?text=Case+Crunch&font=exo', date: 'Upcoming: 18th Dec 2025', regFee: '₹400 / Team', isTeamEvent: true, requiresSubmission: true, coordinatorEmail: 'business.events@cerebrexia.com', teamSize: {min:2, max:4}},
        // --- Arts Events ---
        { id: 9, category: 'Arts', subCategory: 'Visual Arts', title: 'Pixel Perfect (Photography Competition)', shortDescription: 'Capture CEREBREXIA\'25 through your lens.', longDescription: 'Visual storytelling! Capture fest spirit. Themes: \'Festive Vibes\', \'Candid Moments\', \'Architecture & Light\'. Mobile/DSLR allowed. Online submission.', rules: ['Individual.','Min 3, max 5 entries per participant.','Photos original & taken during fest (15th-18th Dec).','Basic editing allowed. No heavy manipulation.','Submission via online portal/link.'], prizes: 'Camera Gear, Workshop Vouchers, Exhibition Opps.', contact: 'Karan S. (Photography Club)', image: 'https://placehold.co/600x400/f1c40f/000000?text=Pixel+Perfect+Shots&font=exo', date: 'Upcoming: 15th-18th Dec 2025', regFee: '₹100 / Participant', isTeamEvent: false, requiresSubmission: true, coordinatorEmail: 'arts.lead@cerebrexia.com' },
        { id: 10, category: 'Arts', subCategory: 'Film', title: 'Cinematic Visions (Short Film Festival)', shortDescription: 'Showcase directorial prowess. Online submission.', longDescription: 'Platform for budding filmmakers. All genres welcome. Tell stories that entertain, inspire, challenge. Judged by filmmakers/critics.', rules: ['Team or individual.','Duration: 5-15 mins (incl. credits).','Original content. No plagiarism.','Subtitles for non-English. MP4 format.','No offensive/explicit content.'], prizes: 'Mentorship, Editing Software, Distribution Opps.', contact: 'Sameer K. (Film Club)', image: 'https://placehold.co/600x400/e67e22/ffffff?text=Cinematic+Visions+Fest&font=exo', date: 'Upcoming Submission (Deadline: 10th Dec 2025)', regFee: '₹400 / Film', isTeamEvent: true, requiresSubmission: true, coordinatorEmail: 'arts.lead@cerebrexia.com', teamSize: {min:1, max:10}},
        { id: 12, category: 'Arts', subCategory: 'Visual Arts', title: 'Canvas Revolution (Wall Painting)', shortDescription: 'Transform blank walls into stunning murals.', longDescription: 'Unleash your inner muralist! Express creativity on designated campus walls. Themes: Social Awareness, Futuristic Visions, Cultural Heritage. Supplies provided.', rules: ['Team: 2-4 members. No solo.','Assigned wall section. Themes on-spot.','Only provided supplies allowed.','Judged on originality, skill, message, neatness, teamwork.'], prizes: 'Art Vouchers, Gallery Showcase, Cash.', contact: 'Prof. R. K. Das (Fine Arts)', image: 'https://placehold.co/600x400/d35400/ffffff?text=Canvas+Revolution&font=exo', date: 'Upcoming: 15th-16th Dec 2025', regFee: '₹500 / Team', isTeamEvent: true, requiresSubmission: false, coordinatorEmail: 'arts.lead@cerebrexia.com', teamSize: {min:2, max:4}},
        { id: 13, category: 'Arts', subCategory: 'Fine Arts', title: 'Mehendi Artistry', shortDescription: 'Intricate Mehendi designs and traditional skills.', longDescription: 'Adorn hands with beautiful patterns. Traditional Indian, Arabic, or contemporary fusion styles. Henna cones provided.', rules: ['Individual participation.','Complete design on model/own hand in 90 mins.','Judged on intricacy, neatness, originality, style adherence.'], prizes: 'Art Kits, Vouchers, Workshop Opp.', contact: 'Meena K. (Arts Society)', image: 'https://placehold.co/600x400/bdc3c7/000000?text=Mehendi+Artistry&font=exo', date: 'Upcoming: 16th Dec 2025', regFee: '₹100 / Solo', isTeamEvent: false, requiresSubmission: false, coordinatorEmail: 'arts.lead@cerebrexia.com' },
        { id: 25, category: 'Arts', subCategory: 'Performing Arts', title: 'Mono Acting: Solo Spotlight', shortDescription: 'Captivate with a powerful solo performance.', longDescription: 'Command the stage alone! Portray multiple characters or an intense narrative. Showcase versatility, emotion, stage presence.', rules: ['Individual.','Duration: 5-8 minutes.','Any theme/story. No offensive content.','Minimal props allowed (optional).'], prizes: 'Cash, Acting Workshops, Theatre Group Opps.', contact: 'Drama Club Head', image: 'https://placehold.co/600x400/2c3e50/ffffff?text=Solo+Spotlight+Act&font=exo', date: 'Upcoming: 17th Dec 2025', regFee: '₹150 / Solo', isTeamEvent: false, requiresSubmission: false, coordinatorEmail: 'performing.arts@cerebrexia.com' },
        { id: 29, category: 'Arts', subCategory: 'Craft', title: 'Best Out of Waste', shortDescription: 'Create art from discarded materials.', longDescription: 'Showcase your creativity and environmental consciousness by transforming waste materials into beautiful and useful art pieces. Promote sustainability through innovation.', rules: ['Individual or Team of 2.','Materials must be primarily waste items.','Create your piece on-spot within 2 hours.','Judged on creativity, utility, and finish.'], prizes: 'Eco-Warrior Award, Craft Kits, Vouchers.', contact: 'Sustainability Club', image: 'https://placehold.co/600x400/7f8c8d/000000?text=Eco+Creations&font=exo', date: 'Upcoming: 17th Dec 2025', regFee: 'Free', isTeamEvent: true, requiresSubmission: false, coordinatorEmail: 'eco.club@cerebrexia.com', teamSize: {min:1, max:2}},
        // --- Sports & Athletics Events ---
        { id: 14, category: 'Sports', subCategory: 'E-Gaming', title: 'En Passant (Chess Battle - Online)', shortDescription: 'Classic battle of wits on the digital board.', longDescription: 'Online chess tournament for strategists. Rapid or blitz formats. Fair play paramount, anti-cheat measures.', rules: ['Individual. Open to all skill levels.','Rapid (10+0) or Blitz (5+0).','Fair play enforced. No external engines/assistance.','Stable internet & verified platform account needed.'], prizes: 'Cash, Premium Chess Memberships, Gaming Peripherals.', contact: 'Ankit S. (Chess Club)', image: 'https://placehold.co/600x400/ecf0f1/000000?text=En+Passant+Chess&font=exo', date: 'Upcoming: Online - 17th-18th Dec 2025', regFee: '₹100 / Solo', isTeamEvent: false, requiresSubmission: false, coordinatorEmail: 'esports@cerebrexia.com' },
        { id: 15, category: 'Sports', subCategory: 'E-Gaming', title: 'SMASH (Valorant Tournament - Online)', shortDescription: 'Team up, strategize, dominate. Tactical shooter.', longDescription: 'Intense firefights! 5v5 tactical shooter. Form squad, hone aim, prove superiority. Dedicated servers, anti-cheat. Live streamed.', rules: ['Team: 5 players (1 sub allowed).','Double-elimination. Map pool/agent bans announced.','Strict anti-cheat. Suspicion = disqualification.','Valid Valorant account & stable internet.'], prizes: 'Cash Pool, High-end Gaming Accessories, In-game Items.', contact: 'E-Sports Coordinator', image: 'https://placehold.co/600x400/3498db/ffffff?text=SMASH+Valorant&font=exo', date: 'Upcoming: Online - 16th-18th Dec 2025', regFee: '₹750 / Team', isTeamEvent: true, requiresSubmission: false, coordinatorEmail: 'esports@cerebrexia.com', teamSize: {min:5, max:6}},
        { id: 16, category: 'Athletics', subCategory: 'Individual', title: 'Sprint Velocity (100m Dash)', shortDescription: 'Test your speed on the track!', longDescription: 'Feel the rush! 100-meter dash. Open to male/female. Professional timing equipment for accuracy.', rules: ['Individual. Male/Female categories.','Standard track rules.','Appropriate sports attire/footwear.','Heats determine finalists.'], prizes: 'Cash, Sports Gear Vouchers, Inter-collegiate Opps.', contact: 'Sports Committee Head', image: 'https://placehold.co/600x400/e67e22/ffffff?text=Sprint+Velocity+100m&font=exo', date: 'Upcoming: 15th Dec 2025', regFee: '₹100 / Solo', isTeamEvent: false, requiresSubmission: false, coordinatorEmail: 'sports.athletics@cerebrexia.com' },
        { id: 17, category: 'Athletics', subCategory: 'Team', title: 'Hoops Uprising (3x3 Basketball)', shortDescription: 'Dribble, shoot, score in 3x3 basketball.', longDescription: 'Hit the court! Inter-departmental 3x3 basketball. Teamwork, strategy, shooting skills. Outdoor court, official referees.', rules: ['Team: 3 players (1 sub allowed).','FIBA 3x3 rules.','Round-robin then knockouts.','Appropriate sports attire.'], prizes: 'Trophies, Sports Equipment, Bragging Rights.', contact: 'Sports Committee Head', image: 'https://placehold.co/600x400/2ecc71/000000?text=Hoops+Uprising+3x3&font=exo', date: 'Upcoming: 16th Dec 2025', regFee: '₹400 / Team', isTeamEvent: true, requiresSubmission: false, coordinatorEmail: 'sports.athletics@cerebrexia.com', teamSize: {min:3, max:4}},
        { id: 22, category: 'Sports', subCategory: 'Individual', title: 'Shuttle Shock (Badminton Singles)', shortDescription: 'Serve, smash, rally to victory.', longDescription: 'Test reflexes and agility. Fast-paced, high-energy. Male/Female categories. Standard BWF rules.', rules: ['Individual.','Knockout format.','Bring own rackets. Shuttles provided.','Sports attire & non-marking shoes mandatory.'], prizes: 'Sports Gear, Cash, Inter-collegiate Opps.', contact: 'Sports Committee Head', image: 'https://placehold.co/600x400/1abc9c/000000?text=Shuttle+Shock+Badminton&font=exo', date: 'Upcoming: 15th Dec 2025', regFee: '₹150 / Solo', isTeamEvent: false, requiresSubmission: false, coordinatorEmail: 'sports.athletics@cerebrexia.com' },
        { id: 24, 'category': 'Sports', subCategory: 'E-Gaming', title: 'Apex Arena (PUBG/BGMI Showdown - Online)', shortDescription: 'Survive and conquer the mobile battle royale.', longDescription: 'Drop into the battleground! Mobile gaming tournament. Teams compete in classic battle royale on custom rooms. Tactical prowess for chicken dinner!', rules: ['Team: 4 players (1 sub allowed).','Standard rules. No emulators.','Anti-cheat enforced. Cheating = disqualification.','Stable internet & charged devices.'], prizes: 'Cash, In-game Currency, Gaming Headphones.', contact: 'E-Sports Club Lead', image: 'https://placehold.co/600x400/f39c12/000000?text=Apex+Arena+Mobile&font=exo', date: 'Upcoming: Online - 18th Dec 2025', regFee: '₹400 / Team', isTeamEvent: true, requiresSubmission: false, coordinatorEmail: 'esports@cerebrexia.com', teamSize: {min:4, max:5}},
        { id: 30, category: 'Sports', subCategory: 'Team', title: 'Volley Fest (Volleyball Tournament)', shortDescription: 'Spike your way to glory!', longDescription: 'Exciting volleyball tournament for teams. Showcase teamwork, strategy, and powerful spikes. Standard volleyball rules apply.', rules: ['Team: 6 players (max 2 subs).','Knockout format.','Proper sports attire required.','Referee decision is final.'], prizes: 'Trophy, Cash Prize, Sports Vouchers.', contact: 'Volleyball Club Captain', image: 'https://placehold.co/600x400/d35400/ffffff?text=Volley+Fest&font=exo', date: 'Upcoming: 17th Dec 2025', regFee: '₹600 / Team', isTeamEvent: true, requiresSubmission: false, coordinatorEmail: 'sports.team@cerebrexia.com', teamSize: {min:6, max:8}},
        // --- Informals & Pro-Events ---
        { id: 6, category: 'Informals', subCategory: 'Comedy', title: 'LOL Arena (Stand-up Comedy)', shortDescription: 'Bring laughter with your wit and humor.', longDescription: 'Tickle funny bones! Original material. Open mic slots after competition.', rules: ['Performance duration: 5-7 minutes.','Original, non-offensive material. Content reviewed.','Judged on originality, delivery, audience engagement, punchlines.'], prizes: 'Cash prizes, comedy club spots, mentorship.', contact: 'Rahul Verma (+91 90000 99999)', image: 'https://placehold.co/600x400/d35400/ffffff?text=LOL+Arena+Comedy&font=exo', date: 'Upcoming: 17th December 2025', regFee: '₹100 / Solo', isTeamEvent: false, requiresSubmission: false, coordinatorEmail: 'informals.lead@cerebrexia.com' },
        { id: 19, category: 'Informals', subCategory: 'Fun', title: 'Cypher Quest (Treasure Hunt)', shortDescription: 'Solve riddles, discover campus treasures.', longDescription: 'Adventurous journey across IGIMS campus! Test wits, teamwork, problem-solving. Race against time, decipher cryptic clues.', rules: ['Team: 3-4 members.','Physical & mental challenges at checkpoints.','First to find treasure wins.','Fair play. No external maps/guides.'], prizes: 'Grand Treasure Chest, Cash, Merch.', contact: 'Fest Management Team', image: 'https://placehold.co/600x400/c0392b/ffffff?text=Cypher+Quest+Hunt&font=exo', date: 'Upcoming: 16th Dec 2025', regFee: '₹250 / Team', isTeamEvent: true, requiresSubmission: false, coordinatorEmail: 'informals.lead@cerebrexia.com', teamSize: {min:3, max:4}},
        { id: 27, category: 'Pro-Events', subCategory: 'Entrepreneurship', title: 'Startup Surge (B-Plan Competition)', shortDescription: 'Pitch your groundbreaking business idea.', longDescription: 'Aspiring entrepreneurs, this is your stage! Present your innovative business plans to a panel of investors and industry experts. Focus on scalability, market potential, and a strong execution strategy.', rules: ['Team: 1-4 members.','Submit executive summary (2 pages max) by 1st Dec.','Shortlisted teams present a detailed B-Plan (10-15 slides, 10 min pitch + 5 min Q&A).','Judged on idea viability, market analysis, financial projections, team strength.'], prizes: 'Seed Funding Upto 1 Lakh, Mentorship, Incubation Space, Networking Opps.', contact: 'Entrepreneurship Cell', image: 'https://placehold.co/600x400/8e44ad/ffffff?text=Startup+Surge+Pitch&font=exo', date: 'Upcoming: 18th Dec 2025', regFee: '₹1000 / Team', isTeamEvent: true, requiresSubmission: true, coordinatorEmail: 'pro.events@cerebrexia.com', teamSize: {min:1, max:4}},
        { id: 31, category: 'Pro-Events', subCategory: 'Talk', title: 'Tech Titans Talk: Future of AI', shortDescription: 'Insightful talk by an AI industry leader.', longDescription: 'Join us for an enlightening session with a renowned expert from the AI industry. Explore the future trends, challenges, and opportunities in Artificial Intelligence. Interactive Q&A session included.', rules: ['Open to all registered CEREBREXIA participants.','Limited seating, first-come, first-served basis (after Pro-Nite pass holders if combined).','Maintain decorum during the session.'], prizes: 'Knowledge, Networking Opportunities.', contact: 'Guest Lecture Committee', image: 'https://placehold.co/600x400/2980b9/ffffff?text=Tech+Titans+AI+Talk&font=exo', date: 'Upcoming: 17th Dec 2025', regFee: 'Free (Entry with Fest Pass)', isTeamEvent: false, requiresSubmission: false, coordinatorEmail: 'pro.events@cerebrexia.com'},
        { id: 50, category: 'Pro-Events', subCategory: 'Workshop', title: 'Advanced DJ Mixing Workshop', shortDescription: 'Learn pro DJ techniques with industry experts.', longDescription: 'Exclusive workshop for aspiring DJs. Covers advanced mixing, effects, and performance skills. Limited seats.', rules: ['Individual participation.','Basic DJ knowledge preferred but not mandatory.','Bring your own laptop and headphones if possible.'], prizes: 'Certificate of Participation, Chance to open for a fest DJ.', contact: 'DJ ProTeam', image: 'https://placehold.co/600x400/ff00ff/ffffff?text=DJ+Workshop&font=exo', date: 'Upcoming: 16th Dec 2025', regFee: '₹1200 / Person', isTeamEvent: false, requiresSubmission: false, coordinatorEmail: 'workshops@cerebrexia.com' },
        { id: 51, category: 'Informals', subCategory: 'Games', title: 'Campus Scavenger Hunt (Free Entry)', shortDescription: 'Explore and solve riddles across campus.', longDescription: 'A fun-filled scavenger hunt designed to test your knowledge of the campus and your problem-solving skills. Teams will race against time to find hidden clues and complete challenges.', rules: ['Team: 2-4 members.','First team to complete all tasks wins.','No use of vehicles allowed.'], prizes: 'Bragging Rights, Goodie Bags, Surprise Vouchers.', contact: 'Informals Team', image: 'https://placehold.co/600x400/00cc66/ffffff?text=Scavenger+Hunt&font=exo', date: 'Upcoming: 17th Dec 2025', regFee: 'Free', isTeamEvent: true, requiresSubmission: false, coordinatorEmail: 'informals@cerebrexia.com', teamSize: {min:2, max:4} }
    ];


    let currentCategory = 'All';
    let currentSubCategory = 'All';
    const body = document.body;

    const categoryFiltersContainer = document.querySelector('.filter-group:nth-child(1)');
    const subCategoryFiltersContainer = document.getElementById('subCategoryFilters');
    const eventsGrid = document.querySelector('.events-grid');
    const modal = document.getElementById('eventRegistrationModal');
    const closeModalButton = document.getElementById('closeModalButton');
    const eventRegForm = document.getElementById('eventRegForm');
    const modalEventTitle = document.getElementById('modalEventTitle');
    const modalEventFee = document.getElementById('modalEventFee');

    const formEventIdInput = document.getElementById('formEventId');
    const formEventNameInput = document.getElementById('formEventName');
    const formEventFeeValueInput = document.getElementById('formEventFeeValue');
    const formCoordinatorEmailInput = document.getElementById('formCoordinatorEmail');
    const formIsTeamEventInput = document.getElementById('formIsTeamEvent');

    const formResponseMessage = document.getElementById('formResponseMessage');
    const modalSubmitButton = document.getElementById('modalSubmitButton');

    const teamFieldsContainer = document.getElementById('teamFieldsContainer');
    const regTeamNameInput = document.getElementById('regTeamName');
    const regTeamMembersCountInput = document.getElementById('regTeamMembersCount');
    const groupMemberDetailsContainer = document.getElementById('groupMemberDetailsContainer');
    const submissionLinkContainer = document.getElementById('submissionLinkContainer');
    const regSubmissionLinkInput = document.getElementById('regSubmissionLink');


    const regFullName = document.getElementById('regFullName');
    const regEmail = document.getElementById('regEmail');
    const regPhone = document.getElementById('regPhone');
    const regCollegeName = document.getElementById('regCollegeName');
    const regYearOfStudy = document.getElementById('regYearOfStudy');

    let currentEvent = null; // To store the event object when modal is open
    let currentUser = null; // To store Firebase authenticated user
    let userProfileLoaded = false; // Flag to track if user profile is loaded

    // --- Firebase Auth State Listener ---
    firebase.auth().onAuthStateChanged(async (user) => {
        currentUser = user;
        if (user) {
            console.log("Firebase user detected:", user.uid);
            // Fetch user profile from Firestore to prefill forms
            try {
                const userDoc = await db.collection('users').doc(user.uid).get();
                if (userDoc.exists) {
                    const profile = userDoc.data();
                    // Prefill basic fields
                    regFullName.value = profile.name || user.displayName || '';
                    regEmail.value = profile.email || user.email || '';
                    regPhone.value = profile.phone || '';
                    regCollegeName.value = profile.college || '';
                    if (profile.yearOfStudy) {
                        regYearOfStudy.value = profile.yearOfStudy;
                    }
                    userProfileLoaded = true;
                    // Disable prefilled fields to prevent manual editing
                    regFullName.readOnly = true;
                    regEmail.readOnly = true;
                    regPhone.readOnly = true;
                    regCollegeName.readOnly = true;
                    regYearOfStudy.disabled = true; // For select, use disabled
                    console.log("User profile prefilled.");
                } else {
                    console.warn("User profile not found in Firestore. Forms will not be prefilled.");
                    // Prompt user to complete profile if they try to register without it
                    userProfileLoaded = false;
                    regFullName.readOnly = false;
                    regEmail.readOnly = false;
                    regPhone.readOnly = false;
                    regCollegeName.readOnly = false;
                    regYearOfStudy.disabled = false;
                }
            } catch (error) {
                console.error("Error fetching user profile:", error);
                userProfileLoaded = false;
            }
        } else {
            console.log("No Firebase user. Forms will not be prefilled.");
            currentUser = null;
            userProfileLoaded = false;
            // Ensure fields are editable if no user is signed in
            regFullName.readOnly = false;
            regEmail.readOnly = false;
            regPhone.readOnly = false;
            regCollegeName.readOnly = false;
            regYearOfStudy.disabled = false;
        }
    });


    function getNumericFee(feeString) {
        if (typeof feeString === 'string' && feeString.toLowerCase().includes('free')) {
            return 0;
        }
        const match = feeString.match(/₹\s*(\d+)/);
        return match ? parseInt(match[1], 10) : 0;
    }


    function renderEvents() {
        eventsGrid.innerHTML = '';
        let filteredEvents = eventsData;

        if (currentCategory !== 'All') {
            filteredEvents = filteredEvents.filter(event => event.category === currentCategory);
        }
        if (currentSubCategory !== 'All') {
            filteredEvents = filteredEvents.filter(event => event.subCategory === currentSubCategory);
        }

        if (filteredEvents.length === 0) {
            eventsGrid.innerHTML = '<p class="col-span-full text-center text-pink-400 text-xl my-10">No events found for the selected filters. Try a different combination!</p>';
            return;
        }

        filteredEvents.forEach(event => {
            const eventCard = document.createElement('article');
            eventCard.className = 'event-card';
            eventCard.setAttribute('data-aos', 'fade-up');
            eventCard.setAttribute('data-event-id', event.id);
            eventCard.setAttribute('tabindex', '0');
            eventCard.setAttribute('role', 'button');
            eventCard.setAttribute('aria-label', `Register for ${event.title}`);

            eventCard.innerHTML = `
                <img src="${event.image}" alt="${event.title}" class="event-image" onerror="this.onerror=null;this.src='https://placehold.co/600x400/333333/ffffff?text=Event+Image&font=exo';" />
                <div class="event-content">
                    <h2 class="event-title">${event.title}</h2>
                    <div class="event-fee">Reg. Fee: ${event.regFee}</div>
                    <p class="event-short-description">${event.shortDescription}</p>
                    <div class="event-date">Date: ${event.date}</div>
                    <div class="accordion-header">
                        Details & Rules
                    </div>
                    <div class="accordion-content">
                        <p>${event.longDescription}</p>
                        <p><strong>Rules:</strong></p>
                        <ul>
                            ${event.rules.map(rule => `<li>- ${rule}</li>`).join('')}
                        </ul>
                        <p><strong>Prizes:</strong> ${event.prizes}</p>
                        <p><strong>Contact:</strong> ${event.contact}</p>
                    </div>
                </div>
            `;
            eventsGrid.appendChild(eventCard);

            eventCard.addEventListener('click', () => openRegistrationModal(event.id));
            eventCard.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    openRegistrationModal(event.id);
                }
            });
        });

        AOS.refresh();
        attachAccordionListeners();
    }

    function renderSubCategoryFilters() {
        subCategoryFiltersContainer.innerHTML = '<label class="text-pink-300 font-semibold mr-2">Sub-Category:</label><button class="filter-button active" data-subcategory="All">All</button>';
        const relevantSubCategories = new Set();
        eventsData.forEach(event => {
            if (currentCategory === 'All' || event.category === currentCategory) {
                relevantSubCategories.add(event.subCategory);
            }
        });
        const sortedSubCategories = Array.from(relevantSubCategories).sort();
        sortedSubCategories.forEach(subCat => {
            const button = document.createElement('button');
            button.className = 'filter-button';
            button.setAttribute('data-subcategory', subCat);
            button.textContent = subCat;
            subCategoryFiltersContainer.appendChild(button);
        });
        subCategoryFiltersContainer.querySelectorAll('.filter-button').forEach(button => {
            button.addEventListener('click', (e) => {
                subCategoryFiltersContainer.querySelectorAll('.filter-button').forEach(btn => btn.classList.remove('active'));
                e.target.classList.add('active');
                currentSubCategory = e.target.getAttribute('data-subcategory');
                renderEvents();
            });
        });
    }

    categoryFiltersContainer.querySelectorAll('.filter-button').forEach(button => {
        button.addEventListener('click', (e) => {
            categoryFiltersContainer.querySelectorAll('.filter-button').forEach(btn => btn.classList.remove('active'));
            e.target.classList.add('active');
            currentCategory = e.target.getAttribute('data-category');
            currentSubCategory = 'All';
            renderSubCategoryFilters();
            const allSubCatButton = subCategoryFiltersContainer.querySelector('.filter-button[data-subcategory="All"]');
            if (allSubCatButton) allSubCatButton.classList.add('active');
            renderEvents();
        });
    });

    function attachAccordionListeners() {
        const accordionHeaders = document.querySelectorAll('.accordion-header');
        accordionHeaders.forEach(header => {
            header.removeEventListener('click', toggleAccordion);
            header.addEventListener('click', toggleAccordion);
        });
    }

    function toggleAccordion(e) {
        e.stopPropagation();
        const header = e.currentTarget;
        const content = header.nextElementSibling;
        const isActive = header.classList.contains('active');
        header.classList.toggle('active', !isActive);
        content.classList.toggle('open', !isActive);
    }

    function generateTeamMemberInputs(count, teamSizeMin = 1) {
        groupMemberDetailsContainer.innerHTML = '';
        const additionalMembers = Math.max(0, count - 1);

        if (additionalMembers > 0) {
            for (let i = 0; i < additionalMembers; i++) {
                const memberDiv = document.createElement('div');
                memberDiv.className = 'grid md:grid-cols-2 gap-4 mt-3 pt-3 border-t border-dashed border-pink-500/30';
                memberDiv.innerHTML = `
                    <div class="form-group">
                        <label for="teamMemberName${i+1}">Member ${i+2} Name: <span class="text-red-500">*</span></label>
                        <input type="text" id="teamMemberName${i+1}" name="teamMemberName${i+1}" placeholder="Member ${i+2} Full Name" class="input-sm" required>
                    </div>
                    <div class="form-group">
                        <label for="teamMemberEmail${i+1}">Member ${i+2} Email: <span class="text-red-500">*</span></label>
                        <input type="email" id="teamMemberEmail${i+1}" name="teamMemberEmail${i+1}" placeholder="Member ${i+2} Email" class="input-sm" required>
                    </div>
                `;
                groupMemberDetailsContainer.appendChild(memberDiv);
            }
        }
    }


    function openRegistrationModal(eventId) {
        currentEvent = eventsData.find(e => e.id === eventId);
        if (!currentEvent) {
            console.error("Event data not found for ID:", eventId);
            return;
        }
        if (!modal || !modalEventTitle || !modalEventFee || !formEventIdInput || !formEventNameInput || !formEventFeeValueInput || !formCoordinatorEmailInput || !formIsTeamEventInput ||!teamFieldsContainer || !submissionLinkContainer) {
            console.error("Modal or essential form elements not found.");
            return;
        }

        modalEventTitle.textContent = `Register for: ${currentEvent.title}`;
        modalEventFee.textContent = `Registration Fee: ${currentEvent.regFee}`;

        eventRegForm.reset(); // Reset form for new event

        // Prefill user data if logged in
        if (currentUser && userProfileLoaded) {
            regFullName.value = currentUser.displayName || '';
            regEmail.value = currentUser.email || '';
            // Phone and college are fetched via profile, ensure they are prefilled
            // If profile data is loaded async, it might not be immediately available here.
            // A more robust way is to fetch profile first, then open modal.
            // For now, rely on onAuthStateChanged's prefill.
        } else {
            // Clear fields if no user or profile not loaded
            regFullName.value = ''; regEmail.value = ''; regPhone.value = ''; regCollegeName.value = ''; regYearOfStudy.value = '';
            regFullName.readOnly = false; regEmail.readOnly = false; regPhone.readOnly = false; regCollegeName.readOnly = false; regYearOfStudy.disabled = false;
            alert('Please sign in (via Profile page) or fill in your details to register.');
        }


        formEventIdInput.value = currentEvent.id;
        formEventNameInput.value = currentEvent.title;
        formEventFeeValueInput.value = getNumericFee(currentEvent.regFee);
        formCoordinatorEmailInput.value = currentEvent.coordinatorEmail;
        formIsTeamEventInput.value = currentEvent.isTeamEvent;

        if (currentEvent.isTeamEvent) {
            teamFieldsContainer.classList.remove('hidden-field');
            if(regTeamNameInput) regTeamNameInput.required = true;
            if(regTeamMembersCountInput) {
                regTeamMembersCountInput.required = true;
                const minSize = currentEvent.teamSize?.min || 1;
                const maxSize = currentEvent.teamSize?.max || 10;
                regTeamMembersCountInput.min = minSize;
                regTeamMembersCountInput.max = maxSize;
                regTeamMembersCountInput.value = minSize; // Default to min team size
                generateTeamMemberInputs(minSize, minSize);
            }
        } else {
            teamFieldsContainer.classList.add('hidden-field');
            if(regTeamNameInput) regTeamNameInput.required = false;
            if(regTeamMembersCountInput) {
                regTeamMembersCountInput.required = false;
                regTeamMembersCountInput.value = '';
            }
            groupMemberDetailsContainer.innerHTML = ''; // Clear team member inputs
        }

        if (regTeamMembersCountInput) {
            regTeamMembersCountInput.removeEventListener('input', handleTeamMemberCountChange); // Prevent multiple listeners
            regTeamMembersCountInput.addEventListener('input', handleTeamMemberCountChange);
        }

        if (currentEvent.requiresSubmission) {
            submissionLinkContainer.classList.remove('hidden-field');
            if(regSubmissionLinkInput) regSubmissionLinkInput.required = true;
        } else {
            submissionLinkContainer.classList.add('hidden-field');
            if(regSubmissionLinkInput) regSubmissionLinkInput.required = false;
        }

        formResponseMessage.classList.add('hidden');
        formResponseMessage.textContent = '';
        modalSubmitButton.disabled = false;
        modalSubmitButton.textContent = 'Submit Entry';

        modal.style.display = 'block';
        body.style.overflow = 'hidden';
        AOS.refreshHard();
    }

    function handleTeamMemberCountChange(e) {
        let count = parseInt(e.target.value);
        const currentEventId = parseInt(formEventIdInput.value);
        const event = eventsData.find(ev => ev.id === currentEventId); // Get event from current id

        if (event && event.isTeamEvent && event.teamSize) {
            const minSize = event.teamSize.min || 1;
            const maxSize = event.teamSize.max || 10;
            if (isNaN(count) || count < minSize) { // Ensure count is valid number and not below min
                count = minSize;
                e.target.value = count;
            } else if (count > maxSize) {
                count = maxSize;
                e.target.value = count;
            }
        } else if (isNaN(count) || count < 1) { // For non-team events or if teamSize is not set
            count = 1; // Default to 1 member for individual/unspecified events
            e.target.value = count;
        }
        generateTeamMemberInputs(count, currentEvent?.teamSize?.min || 1);
    }


    if (closeModalButton && modal) {
        closeModalButton.onclick = function() {
            modal.style.display = "none";
            body.style.overflow = 'auto';
            eventRegForm.reset(); // Reset form on close
            teamFieldsContainer.classList.add('hidden-field'); // Hide team fields
            submissionLinkContainer.classList.add('hidden-field'); // Hide submission fields
            groupMemberDetailsContainer.innerHTML = ''; // Clear generated inputs
            modalSubmitButton.disabled = false;
            modalSubmitButton.textContent = 'Submit Entry';
            formResponseMessage.classList.add('hidden'); // Hide message
        }
    }

    window.onclick = function(event) {
        if (event.target == modal && modal) {
            modal.style.display = "none";
            body.style.overflow = 'auto';
            eventRegForm.reset();
            teamFieldsContainer.classList.add('hidden-field');
            submissionLinkContainer.classList.add('hidden-field');
            groupMemberDetailsContainer.innerHTML = '';
            modalSubmitButton.disabled = false;
            modalSubmitButton.textContent = 'Submit Entry';
            formResponseMessage.classList.add('hidden');
        }
    }
    document.addEventListener('keydown', function(event) {
        if (event.key === "Escape" && modal && modal.style.display === 'block') {
            modal.style.display = "none";
            body.style.overflow = 'auto';
            eventRegForm.reset();
            teamFieldsContainer.classList.add('hidden-field');
            submissionLinkContainer.classList.add('hidden-field');
            groupMemberDetailsContainer.innerHTML = '';
            modalSubmitButton.disabled = false;
            modalSubmitButton.textContent = 'Submit Entry';
            formResponseMessage.classList.add('hidden');
        }
    });

    if (eventRegForm) {
        eventRegForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            modalSubmitButton.disabled = true;
            modalSubmitButton.textContent = 'Processing...';
            formResponseMessage.classList.add('hidden');
            formResponseMessage.textContent = '';

            if (!currentUser) {
                formResponseMessage.textContent = "Please sign in (via Profile page) to register for events.";
                formResponseMessage.className = 'error p-3 rounded-md';
                modalSubmitButton.disabled = false; modalSubmitButton.textContent = 'Submit Entry';
                formResponseMessage.classList.remove('hidden');
                return;
            }

            // Check if essential profile info is filled before allowing submission
            if (!regFullName.value || !regEmail.value || !regPhone.value || !regCollegeName.value || !regYearOfStudy.value) {
                formResponseMessage.textContent = "Please complete all your profile details (Name, Email, Phone, College, Year of Study). Go to Profile page if fields are locked.";
                formResponseMessage.className = 'error p-3 rounded-md';
                modalSubmitButton.disabled = false; modalSubmitButton.textContent = 'Submit Entry';
                formResponseMessage.classList.remove('hidden');
                return;
            }


            const formData = new FormData(eventRegForm);
            const data = Object.fromEntries(formData.entries());

            data.userId = currentUser.uid; // Add Firebase User ID
            data.userEmail = currentUser.email; // Add Firebase user email for consistency

            data.teamDetails = [];
            const isTeamEventFromForm = data.isTeamEvent === 'true';
            const teamMembersCount = parseInt(data.teamMembersCount) || 0;

            if (isTeamEventFromForm && teamMembersCount > 1) {
                // Team leader is member 1, so additional members are count - 1
                const additionalMembers = teamMembersCount - 1;
                for (let i = 0; i < additionalMembers; i++) {
                    const memberName = formData.get(`teamMemberName${i + 1}`);
                    const memberEmail = formData.get(`teamMemberEmail${i + 1}`);
                    if (memberName && memberEmail) {
                        data.teamDetails.push({ name: memberName, email: memberEmail });
                    }
                }
            }

            const numericFee = parseFloat(data.eventFeeValue);

            console.log("Submitting to backend /api/register-event. Data:", JSON.stringify(data, null, 2));
            formResponseMessage.textContent = numericFee > 0 ? 'Initiating registration...' : 'Submitting your entry...';
            formResponseMessage.className = 'success p-3 rounded-md';
            formResponseMessage.classList.remove('hidden');

            try {
                const response = await fetch('http://localhost:8080/api/register-event', { // Target new backend endpoint
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                const result = await response.json();

                if (response.ok) {
                    if (numericFee > 0 && result.orderId) { // Paid event, proceed to Razorpay
                        formResponseMessage.textContent = 'Registration initiated. Redirecting to payment...';
                        const razorpayOptions = {
                            key: result.razorpayKey, amount: result.amount, currency: result.currency,
                            name: "CEREBREXIA'25 Event", description: `Registration for ${result.eventName}`,
                            image: 'https://www.igims.org/wp-content/uploads/2017/10/logo_igims.png',
                            order_id: result.orderId,
                            handler: async function (paymentResponse) {
                                formResponseMessage.textContent = 'Payment successful! Verifying with server...';
                                try {
                                    const verifyResponse = await fetch('http://localhost:8080/api/payment/callback', { // Callback for event payments
                                        method: 'POST', headers: { 'Content-Type': 'application/json' },
                                        body: JSON.stringify({
                                            razorpay_order_id: paymentResponse.razorpay_order_id,
                                            razorpay_payment_id: paymentResponse.razorpay_payment_id,
                                            razorpay_signature: paymentResponse.razorpay_signature,
                                            registration_type: 'event', // Important: specify 'event' type
                                            dbRegistrationId: result.dbRegistrationId // Pass db registration ID
                                        })
                                    });
                                    const verifyResult = await verifyResponse.json(); // Parse as JSON
                                    if (verifyResponse.ok && verifyResult.status === "success") {
                                        formResponseMessage.textContent = 'Payment confirmed! Your entry is submitted. Check your email for details.';
                                        formResponseMessage.className = 'success p-3 rounded-md';
                                        eventRegForm.reset();
                                        if (formIsTeamEventInput) formIsTeamEventInput.value = 'false';
                                        teamFieldsContainer.classList.add('hidden-field');
                                        submissionLinkContainer.classList.add('hidden-field');
                                        groupMemberDetailsContainer.innerHTML = '';
                                        setTimeout(() => { if(modal) modal.style.display = "none"; body.style.overflow = 'auto';}, 4500);
                                    } else {
                                        formResponseMessage.textContent = `Payment verification failed: ${verifyResult.message || 'Unknown error'}. Please contact support.`;
                                        formResponseMessage.className = 'error p-3 rounded-md';
                                        modalSubmitButton.disabled = false; modalSubmitButton.textContent = 'Submit Entry';
                                    }
                                } catch (verifyError) {
                                    console.error("Payment verification fetch error:", verifyError);
                                    formResponseMessage.textContent = 'Error verifying payment: ' + verifyError.message;
                                    formResponseMessage.className = 'error p-3 rounded-md';
                                    modalSubmitButton.disabled = false; modalSubmitButton.textContent = 'Submit Entry';
                                }
                                formResponseMessage.classList.remove('hidden');
                            },
                            prefill: { name: data.fullName, email: data.email, contact: data.phone },
                            notes: { event_registration_id: result.dbRegistrationId }, // Use event_registration_id in notes
                            theme: { color: '#ff00ff' }
                        };
                        const rzp = new Razorpay(razorpayOptions);
                        rzp.on('payment.failed', function (rzpResponse) {
                            console.error('Razorpay payment failed:', rzpResponse.error);
                            formResponseMessage.textContent = `Payment Failed: ${rzpResponse.error.description || rzpResponse.error.reason || 'Unknown Error'}. Please try again or contact support.`;
                            formResponseMessage.className = 'error p-3 rounded-md';
                            formResponseMessage.classList.remove('hidden');
                            modalSubmitButton.disabled = false; modalSubmitButton.textContent = 'Submit Entry';
                            // Optional: Update Firestore to mark payment as failed
                            // db.collection('eventRegistrations').doc(result.dbRegistrationId).update({ paymentStatus: 'failed', errorDetails: rzpResponse.error });
                        });
                        rzp.open();
                    } else if (numericFee === 0) { // Free event successfully submitted to backend
                        formResponseMessage.textContent = result.message || 'Successfully registered for free event! Check your email.';
                        formResponseMessage.className = 'success p-3 rounded-md';
                        eventRegForm.reset();
                        if (formIsTeamEventInput) formIsTeamEventInput.value = 'false';
                        teamFieldsContainer.classList.add('hidden-field');
                        submissionLinkContainer.classList.add('hidden-field');
                        groupMemberDetailsContainer.innerHTML = '';
                        setTimeout(() => { if(modal) modal.style.display = "none"; body.style.overflow = 'auto'; }, 3500);
                    } else { // Paid event but no orderId, or other issue from backend
                        formResponseMessage.textContent = `Error: ${result.message || 'Could not initiate registration. Please try again.'}`;
                        formResponseMessage.className = 'error p-3 rounded-md';
                        modalSubmitButton.disabled = false; modalSubmitButton.textContent = 'Submit Entry';
                    }
                } else { // Response not OK from /api/register-event
                    formResponseMessage.textContent = `Error: ${result.message || 'Could not submit your entry. Please try again.'}`;
                    formResponseMessage.className = 'error p-3 rounded-md';
                    modalSubmitButton.disabled = false; modalSubmitButton.textContent = 'Submit Entry';
                }
            } catch (fetchError) {
                console.error("Registration fetch error:", fetchError);
                formResponseMessage.textContent = 'Network error or server issue: ' + fetchError.message;
                formResponseMessage.className = 'error p-3 rounded-md';
                modalSubmitButton.disabled = false; modalSubmitButton.textContent = 'Submit Entry';
            }
            formResponseMessage.classList.remove('hidden');
        });
    }

    // Header Menu Toggle Logic (from index.html)
    const newMenuToggleButton = document.getElementById('newMenuToggleButton');
    const fullScreenNav = document.getElementById('fullScreenNav');
    const navCloseButton = document.getElementById('navCloseButton');

    if (newMenuToggleButton && fullScreenNav && navCloseButton) {
        newMenuToggleButton.addEventListener('click', () => {
            const isExpanded = newMenuToggleButton.getAttribute('aria-expanded') === 'true' || false;
            newMenuToggleButton.setAttribute('aria-expanded', String(!isExpanded));
            newMenuToggleButton.classList.toggle('open');
            fullScreenNav.classList.toggle('active');
            body.style.overflow = fullScreenNav.classList.contains('active') ? 'hidden' : '';
        });
        navCloseButton.addEventListener('click', () => {
            newMenuToggleButton.setAttribute('aria-expanded', 'false'); newMenuToggleButton.classList.remove('open');
            fullScreenNav.classList.remove('active'); body.style.overflow = '';
        });
        fullScreenNav.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', (e) => {
                const currentPath = window.location.pathname.split('/').pop();
                const linkPath = link.getAttribute('href').split('/').pop();
                if (currentPath === linkPath && link.classList.contains('active-nav-link')) {
                    if (fullScreenNav.classList.contains('active')) {
                        newMenuToggleButton.setAttribute('aria-expanded', 'false'); newMenuToggleButton.classList.remove('open');
                        fullScreenNav.classList.remove('active'); body.style.overflow = '';
                    }
                } else {
                    // Standard navigation, close menu
                    newMenuToggleButton.setAttribute('aria-expanded', 'false'); newMenuToggleButton.classList.remove('open');
                    fullScreenNav.classList.remove('active'); body.style.overflow = '';
                }
            });
        });
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape' && fullScreenNav.classList.contains('active')) {
                newMenuToggleButton.setAttribute('aria-expanded', 'false'); newMenuToggleButton.classList.remove('open');
                fullScreenNav.classList.remove('active'); body.style.overflow = '';
            }
        });
    }

    // Scroll Top Button (from index.html)
    const scrollTopBtn = document.querySelector('.scroll-top-btn');
    if (!scrollTopBtn) { // Dynamically add if not already in HTML
        const tempScrollTopBtn = document.createElement('button');
        tempScrollTopBtn.className = 'scroll-top-btn';
        tempScrollTopBtn.setAttribute('aria-label', 'Scroll to top');
        tempScrollTopBtn.textContent = '▲';
        document.body.appendChild(tempScrollTopBtn);
        // Add minimal styles for dynamic button
        const style = document.createElement('style');
        style.innerHTML = `
            .scroll-top-btn {
                position: fixed; bottom: 20px; right: 20px; background: rgba(13,0,31,0.85); color: #fff;
                border: none; border-radius: 5px; padding: 10px 15px; cursor: pointer;
                opacity: 0; visibility: hidden; transition: opacity .3s ease,visibility .3s ease; z-index: 1000;
            }
            .scroll-top-btn.show { opacity: 1; visibility: visible; }
            .scroll-top-btn:hover { background: #ff00ff; }
        `;
        document.head.appendChild(style);
        const actualScrollTopBtn = document.querySelector('.scroll-top-btn'); // Re-select after adding
        if (actualScrollTopBtn) { // Attach listeners to the dynamically added button
            window.addEventListener('scroll', () => {
                if (window.scrollY > window.innerHeight / 2) { actualScrollTopBtn.classList.add('show'); }
                else { actualScrollTopBtn.classList.remove('show'); }
            });
            actualScrollTopBtn.addEventListener('click', () => { window.scrollTo({ top: 0, behavior: 'smooth' }); });
        }
    } else { // Attach listeners if already in HTML
        window.addEventListener('scroll', () => {
            if (window.scrollY > window.innerHeight / 2) { scrollTopBtn.classList.add('show'); }
            else { scrollTopBtn.classList.remove('show'); }
        });
        scrollTopBtn.addEventListener('click', () => { window.scrollTo({ top: 0, behavior: 'smooth' }); });
    }


    // Initial render
    document.addEventListener('DOMContentLoaded', () => {
        renderSubCategoryFilters();
        renderEvents();
    });
</script>

</body>
</html>